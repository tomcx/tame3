/*!
 * TAME [TwinCAT ADS Made Easy] V3.5 alpha
 * 
 * Copyright (c) 2009-2015 Thomas Schmidt; t.schmidt.p1 at freenet.de
 * 
 * Dual licensed under:
 *  MIT - http://www.opensource.org/licenses/mit-license
 *  GPLv3 - http://www.opensource.org/licenses/GPL-3.0
 * 
 */
var TAME={weekdShortNames:{ge:["So","Mo","Di","Mi","Do","Fr","Sa"],en:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},weekdLongNames:{ge:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],en:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},monthsShortNames:{ge:["Jan","Feb","Mrz","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],en:["Jan","Feb","Mar","Apr","May","Jun","July","Aug","Sept","Oct","Nov","Dez"]},monthsLongNames:{ge:["Januar","Februar","MÃ¤rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],en:["January","February","March","April","May","June","July","August","September","October","November","December"]}};TAME.WebServiceClient=function(f){function k(ak){try{window.console.log(ak)}catch(al){alert(ak)}}var X=this,l={M:16416,MX:16417,DB:16448,I:61472,IX:61473,Q:61488,QX:61489,Upload:61451,UploadInfo:61452,SumRd:61568,SumWr:61569,SumRdWr:61570},z={BOOL:1,BYTE:1,USINT:1,SINT:1,WORD:2,UINT:2,INT:2,INT16:2,INT1DP:2,DWORD:4,UDINT:4,DINT:4,TIME:4,TOD:4,TIME_OF_DAY:4,DATE:4,DT:4,DATE_AND_TIME:4,POINTER:4,REAL:4,LREAL:8,STRING:80,EndStruct:0},R=["INVALID","IDLE","RESET","INIT","START","RUN","STOP","SAVECFG","POWERGOOD","ERROR","SHUTDOWN","SUSPEND","RESUME","CONFIG","RECONFIG"],g=(typeof f.language==="string")?f.language:"ge",m=(function(){var e={},al="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ak;for(ak=0;ak<al.length;ak++){e[ak]=al.charAt(ak)}return e}()),p=(function(){var e={},al="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ak;for(ak=0;ak<al.length;ak++){e[al.charAt(ak)]=ak}return e}()),a=1,D=[0],N={},h=false,b=0,u=0;if(typeof f.serviceUrl!=="string"){k("TAME library error: Service URL is not a string!");return}if(typeof f.amsNetId!=="string"){k("TAME library error: NetId is not a string!");return}if(f.amsPort===undefined){f.amsPort="801";k("TAME library warning: AMS port number is not set! Default port 801 will be used.")}else{if(typeof f.amsPort==="number"){k("TAME library warning: AMS port number is not a string! Trying to convert it.");f.amsPort=f.amsPort.toString(10)}}if(parseInt(f.amsPort,10)<801||parseInt(f.amsPort,10)>891){k("TAME library error: AMS Port Number ("+parseInt(f.amsPort,10)+") is out of range (801-891)!");return}if(f.dataAlign4===true){a=4}else{if(f.alignment===undefined){a=1}else{if(typeof f.alignment==="string"){a=parseInt(f.alignment,10)}else{if(typeof f.alignment==="number"){a=f.alignment}}}}k("TAME library info: Data alignment set to: "+a);if(a!==1&&a!==4&&a!==8){k("TAME library warning: The value for the alignment should be 1, 4 or 8.")}if(f.syncXmlHttp===true){k('TAME library info: The "syncXmlHttp" parameter was set. Synchronous XMLHttpRequests are used by default.')}if(typeof f.serviceUser==="string"&&typeof f.servicePassword==="string"){k("TAME library info: Username and password set. Authenticated requests will be used.")}else{f.serviceUser=null;f.servicePassword=null}this.dateNames={weekdShort:TAME.weekdShortNames[g],weekdLong:TAME.weekdLongNames[g],monthsShort:TAME.monthsShortNames[g],monthsLong:TAME.monthsLongNames[g]};this.maxStringLen=255;this.maxDropReq=10;this.useCheckBounds=true;this.adsState=null;this.adsStateTxt="";this.deviceState=null;function y(e,am,al,ao,ar){var an=[],aq=0,ap=[],ak=0;if(typeof e==="number"){an[0]=e.toString(10)}else{if(typeof e==="string"){an=e.split(".")}else{k("TAME library error: Can't parse name of object/variable. Name is not a string or number!");k(e);return}}if(al===undefined){al=window}aq=an.length-1;while(ak<aq){if(an[ak].charAt(an[ak].length-1)==="]"){ap=an[ak].substring(0,an[ak].length-1).split("[");al=al[ap[0]][ap[1]]}else{if(al[an[ak]]===undefined){al[an[ak]]=[]}al=al[an[ak]]}ak++}if(an[ak].charAt(an[ak].length-1)==="]"){ap=an[ak].substring(0,an[ak].length-1).split("[");al=al[ap[0]];if(am!==undefined){if(typeof ao==="string"){am=ao+am}if(typeof ar==="string"){am=am+ar}al[ap[1]]=am}return al[ap[1]]}if(am!==undefined){if(typeof ao==="string"){am=ao+am}if(typeof ar==="string"){am=am+ar}al[an[ak]]=am}return al[an[ak]]}function ai(e){if(e===undefined){return false}if(!isNaN(e)&&e>0&&e<=X.maxStringLen){return true}k("TAME library error: User defined string length not valid! length: "+e);k("Max. string length: "+X.maxStringLen);return false}function x(al){var ak;if(al.addr){if(typeof al.addr==="string"&&al.addr.charAt(0)==="%"){if(al.addr.charAt(2)==="X"){ak=l[al.addr.substr(1,2)]}else{ak=l[al.addr.substr(1,1)]}}else{k('TAME library error: Wrong address definition, should be a string and start with "%"!');k(al);return}}else{if(al.name){if(typeof al.name==="string"){try{ak=N[al.name].indexGroup}catch(am){k("TAME library error: Can't get the IndexGroup for this request!");k("TAME library error: Please check the variable name.");k(am);k(al);return}}else{k("TAME library error: Varible name should be a string!");k(al);return}}else{k("TAME library error: Neither a name nor an address for the variable/request defined!");k(al);return}}if(isNaN(ak)){k("TAME library error: IndexGroup is not a number, check address or name definition of the variable/request!");k(al)}return ak}function j(al){var ao,ak="",am=[];if(al.addr){if(typeof al.addr==="string"&&al.addr.charAt(0)==="%"){if(al.addr.charAt(2)==="X"){ak=al.addr.substr(3);am=ak.split(".");ao=parseInt(am[0],10)*8+parseInt(am[1],10)}else{ao=parseInt(al.addr.substr(3),10);if(typeof al.addrOffset==="number"){ao+=al.addrOffset}}}else{k('TAME library error: Wrong address definition, should be a string and start with "%"!');k(al);return}}else{if(al.name){if(typeof al.name==="string"){try{ao=N[al.name].indexOffset;if(typeof al.addrOffset==="number"){ao+=al.addrOffset}if(typeof al.bitOffset==="string"){ao+=parseInt(al.bitOffset,10)/8}else{if(typeof al.bitOffset==="number"){ao+=al.bitOffset/8}}}catch(an){k("TAME library error: Can't get the IndexOffset for this request!");k("TAME library error: Please check the variable name.");k(an);k(al);return}}else{k("TAME library error: Varible name should be a string!");k(al);return}}else{k("TAME library error: Neither a name nor an address for the variable/request defined!");k(al);return}}if(isNaN(ao)){k("TAME library error: IndexOffset is not a number, check address or name definition of the variable/request.");k(al)}return ao}function W(){var al;if(window.XMLHttpRequest){al=new window.XMLHttpRequest()}else{try{al=new window.ActiveXObject("Msxml2.XMLHTTP")}catch(am){try{al=new window.ActiveXObject("Microsoft.XMLHTTP")}catch(ak){al=null;k("TAME library error: Failed Creating XMLHttpRequest-Object!")}}}return al}function t(e){if(e.reqDescr===undefined){e.reqDescr={}}else{if(e.reqDescr.debug){k(e)}}e.send=function(){var ak,al;if(typeof this.reqDescr.id==="number"&&D[this.reqDescr.id]>0){k("TAME library warning: Request dropped (last request with ID "+e.reqDescr.id+" not finished!)");D[this.reqDescr.id]++;if(D[this.reqDescr.id]<=X.maxDropReq){return}D[this.reqDescr.id]=0}if(e.sync===true){al=false}else{if(this.reqDescr.sync===true){al=false}else{if(this.reqDescr.sync===false){al=true}else{if(f.syncXmlHttp===true){al=false}else{al=true}}}}this.xmlHttpReq=W();ak="<?xml version='1.0' encoding='utf-8'?>";ak+="<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' ";ak+="xmlns:xsd='http://www.w3.org/2001/XMLSchema' ";ak+="xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'>";ak+="<soap:Body><q1:";ak+=this.method;ak+=" xmlns:q1='http://beckhoff.org/message/'><netId xsi:type='xsd:string'>";ak+=f.amsNetId;ak+="</netId><nPort xsi:type='xsd:int'>";ak+=f.amsPort;ak+="</nPort>";if(this.indexGroup!==undefined){ak+="<indexGroup xsi:type='xsd:unsignedInt'>";ak+=this.indexGroup;ak+="</indexGroup>"}if(this.indexOffset!==undefined){ak+="<indexOffset xsi:type='xsd:unsignedInt'>";ak+=this.indexOffset;ak+="</indexOffset>"}if((this.method==="Read"||this.method==="ReadWrite")&&this.reqDescr.readLength>0){ak+="<cbRdLen xsi:type='xsd:int'>";ak+=this.reqDescr.readLength;ak+="</cbRdLen>"}if(this.pData&&this.pData.length>0){ak+="<pData xsi:type='xsd:base64Binary'>";ak+=this.pData;ak+="</pData>"}if(this.pwrData&&this.pwrData.length>0){ak+="<pwrData xsi:type='xsd:base64Binary'>";ak+=this.pwrData;ak+="</pwrData>"}ak+="</q1:";ak+=this.method;ak+="></soap:Body></soap:Envelope>";if(typeof this.xmlHttpReq==="object"){this.xmlHttpReq.open("POST",f.serviceUrl,al,f.serviceUser,f.servicePassword);this.xmlHttpReq.setRequestHeader("SOAPAction","http://beckhoff.org/action/TcAdsSync."+this.method);this.xmlHttpReq.setRequestHeader("Content-Type","text/xml; charset=utf-8");if(al===true){this.xmlHttpReq.onreadystatechange=function(){if((e.xmlHttpReq.readyState===4)&&(e.xmlHttpReq.status===200)){X.parseResponse(e)}};this.xmlHttpReq.send(ak)}else{this.xmlHttpReq.send(ak);X.parseResponse(e)}if(typeof this.reqDescr.id==="number"){D[this.reqDescr.id]=1}}};return e}function S(am,al,ak,e){var an;if(typeof am.val==="string"){if(al==="REAL"||al==="LREAL"){an=parseFloat(am.val)}else{an=parseInt(am.val,10)}}else{if(typeof am.val==="number"){an=am.val}else{k("TAME library error: Wrong variable type for a numeric variable in write request!");k("TAME library error: Variable type should be number or string, but is "+typeof am.val);k(am);an=0}}if(isNaN(an)){an=0;k("TAME library error: Value of a numeric variable in write request is not a number.");k(am)}if(X.useCheckBounds===true){if(al==="LREAL"){if(!isFinite(an)){k("TAME library warning: Limit for LREAL value exceeded!");k("Upper limit: "+Number.MAX_VALUE);k("Lower limit: "+Number.MIN_VALUE);k("value: "+an);k(am)}}else{if(al==="REAL"){if(an>0){if(an<1.175495e-38){k("TAME library warning: Lower limit for positive REAL value exceeded!");k("limit: 1.175495e-38");k("value: "+an);k(am);an=1.175495e-38}else{if(an>3.402823e+38){k("TAME library warning: Upper limit for positive REAL value exceeded!");k("limit: 3.402823e+38");k("value: "+an);k(am);an=3.402823e+38}}}else{if(an<0){if(an>-1.175495e-38){k("TAME library warning: Upper limit for negative REAL value exceeded!");k("limit: -1.175495e-38");k("value: "+an);k(am);an=-1.175495e-38}else{if(an<-3.402823e+38){k("TAME library warning: Lower limit for negative REAL value exceeded!");k("limit: -3.402823e+38");k("value: "+an);k(am);an=-3.402823e+38}}}}}else{if(an<ak){k("TAME library warning: Lower limit for numeric value exceeded!");k("type: "+al);k("limit: "+ak);k("value: "+an);k(am);an=ak}else{if(an>e){k("TAME library warning: Upper limit for numeric value exceeded!");k("type: "+al);k("limit: "+e);k("value: "+an);k(am);an=e}}}}}return an}function af(al){var ak=[];if(typeof al.type==="string"){ak=al.type.split(".");if(ak.length>2){ak[1]=ak.slice(1).join(".")}}else{if(h&&typeof al.name==="string"){try{ak[0]=N[al.name].type;if(ak[0]==="STRING"){ak[1]=N[al.name].stringLength}else{if(typeof al.format==="string"){ak[1]=al.format}else{if(typeof al.decPlaces==="number"){ak[1]=al.decPlaces}else{if(typeof al.dp==="number"){ak[1]=al.dp}}}}}catch(am){k("TAME library error: A problem occured while reading a data type from the symbol table!");k(am);k(al)}}else{k("TAME library error: Could not get the type of the item!");k(al)}}return ak}function I(e){if((e>=97)&&(e<=102)){return(e-87)}if((e>=65)&&(e<=70)){return(e-55)}if((e>=48)&&(e<=57)){return(e-48)}return 0}function ad(an,ak){var e=[],am=an.toString(16),al;while(am.length<ak*2){am="0"+am}for(al=0;al<ak;al++){e[(ak-1)-al]=((I(am.charCodeAt(al*2))*16)+I(am.charCodeAt((al*2)+1)))}return e}function r(ak){var an=0,aq=0,ao,e,am,ap,al;e=Math.abs(ak);if(ak!==0){for(al=128;al>-127;al--){am=e/Math.pow(2,al);if(am>=2){break}ap=al;ao=am}ap+=127;ao=ao.toString(2);for(al=2;al<25;al++){an<<=1;if(ao.charAt(al)==="1"){an+=1}}if(ao.charAt(25)==="1"){an+=1}aq=ap;aq<<=23;aq+=an;if(ak<0){aq+=2147483648}}return aq}function C(ap){var al=0,ar=0,am={part1:0,part2:0},at,ao,ak,e,aq,an;at=Math.abs(ap);if(ap!==0){for(an=1024;an>=-1023;an--){ao=at/Math.pow(2,an);if(ao>=2){break}ak=an;aq=ao}ak+=1023;aq=aq.toString(2);for(an=2;an<22;an++){al<<=1;if(aq.charAt(an)==="1"){al+=1}}if(aq.charAt(an)==="1"){e=true}an++;for(an;an<54;an++){ar<<=1;if(aq.charAt(an)==="1"){ar+=1}}am.part1=ak;am.part1<<=20;am.part1+=al;if(ap<0){am.part1+=2147483648}am.part2=ar;if(e===true){am.part2+=2147483648}}return am}function J(al,ak){var e;switch(ak){case"#d":case"#dd":e=al*86400000;break;case"#h":case"#hh":e=al*3600000;break;case"#m":case"#mm":e=al*60000;break;case"#s":case"#ss":e=al*1000;break;case"#ms":case"#msmsms":e=al;break;default:e=al;break}return e}function A(aq,at){var e=at.split("#"),ap=e.length,ar=/:|\.|-|_/,al=0,ak=0,an,am,ao,au;for(am=1;am<ap;am++){if(ar.test(e[am])===true){au=true}}if(au!==true){k("TAME library error: No separator ( : . - _ ) for TOD string found!");k("String: "+aq);k("Format: "+at);return 0}ao=aq.split(ar);for(am=1;am<ap;am++){switch(e[am]){case"h":case"hh":an=parseInt(ao[ak],10)*3600000;ak++;break;case"m":case"mm":an=parseInt(ao[ak],10)*60000;ak++;break;case"s":case"ss":an=parseInt(ao[ak],10)*1000;ak++;break;case"ms":case"msmsms":an=parseInt(ao[ak],10);ak++;break;default:an=0}al+=an}return al}function o(ap){var ao=m,am=0,ak="",an,al,e;while(am<ap.length){an=ap[am++];al=ap[am++];e=ap[am++];ak=ak+ao[an>>2]+ao[((an&3)<<4)|(al>>4)]+(isNaN(al)?"=":ao[(((al&15)<<2)|(e>>6))])+((isNaN(al)||isNaN(e))?"=":ao[e&63])}return ak}function d(ap,an,ao,am){var ar=[],e,aq,ak,al;if(ap.val===undefined){switch(an){case"STRING":ap.val="";break;case"DATE":case"DT":case"TOD":case"TIME_OF_DAY":case"DATE_AND_TIME":ap.val=new Date();break;default:ap.val=0;break}k("TAME library warning: Value of a variable in write request is not defined!");k(ap)}switch(an){case"BOOL":if(ap.val){ar[0]=1}else{ar[0]=0}break;case"BYTE":case"USINT":e=S(ap,an,0,255);ar=ad(e,am);break;case"SINT":e=S(ap,an,-128,127);if(e<0){e=e+256}ar=ad(e,am);break;case"WORD":case"UINT":e=S(ap,an,0,65535);ar=ad(e,am);break;case"INT":case"INT16":e=S(ap,an,-32768,32767);if(e<0){e=e+65536}ar=ad(e,am);break;case"INT1DP":ap.val=Math.round(ap.val*10);e=S(ap,an,-32768,32767);if(e<0){e=e+65536}ar=ad(e,am);break;case"DWORD":case"UDINT":e=S(ap,an,0,4294967295);ar=ad(e,am);break;case"DINT":e=S(ap,an,-2147483648,2147483647);if(e<0){e=e+4294967296}ar=ad(e,am);break;case"REAL":e=S(ap,an);e=r(e);ar=ad(e,am);break;case"LREAL":e=S(ap,an);e=C(e);ar=ad(e.part2,4);ar=ar.concat(ad(e.part1,4));break;case"DATE":if(typeof ap.val==="object"){ap.val.setHours(0);ap.val.setMinutes(0);ap.val.setSeconds(0);e=ap.val.getTime()/1000-ap.val.getTimezoneOffset()*60}else{k("TAME library error: Value of a DATE variable in write request is not a date object!");k(ap)}ar=ad(e,am);break;case"DT":case"DATE_AND_TIME":if(typeof ap.val==="object"){e=ap.val.getTime()/1000-ap.val.getTimezoneOffset()*60}else{k("TAME library error: Value of a DT variable in write request is not a date object!");k(ap)}ar=ad(e,am);break;case"TOD":case"TIME_OF_DAY":if(typeof ap.val==="object"){ap.val.setYear(1970);ap.val.setMonth(0);ap.val.setDate(1);e=ap.val.getTime()-ap.val.getTimezoneOffset()*60000}else{if(typeof ap.val==="string"){if(ao===""||ao===undefined){ao="#hh#:#mm";k("TAME library warning: No format given for TOD string! Using default #hh#:#mm.");k(ap)}e=A(ap.val,ao)}else{k("TAME library error: TOD value in write request is wether a date object nor a string!");k(ap)}}ar=ad(e,am);break;case"STRING":aq=(ao===undefined)?z.STRING:parseInt(ao,10);if(ai(aq)){ak=aq<ap.val.length?aq:ap.val.length;for(al=0;al<ak;al++){ar[al]=ap.val.charCodeAt(al)}for(al;al<aq;al++){ar[al]=0}ar[al]=0}break;case"TIME":e=parseInt(ap.val,10);if(isNaN(e)){k("TAME library warning: Value of a TIME variable in write request is not defined!");k(ap);e=0}e=J(e,ao);if(e<0){e=0;k("TAME library warning: Lower limit for TIME variable in write request exceeded!)");k("value: "+ap.val+ao);k(ap)}else{if(e>4294967295){e=4294967295;k("TAME library warning: Upper limit for TIME variable in write request exceeded!)");k("value: "+ap.val+ao);k(ap)}}ar=ad(e,am);break;case"EndStruct":break;default:k("TAME library error: Unknown data type in write request : "+an);break}return ar}function s(ak){var e=ak.toString(16);if((e.length%2)!==0){e="0"+e}return e}function i(ak,e){e=(isNaN(e))?0:e;var al=ak.toString(10);while(al.length<e){al="0"+al}return al}function aj(ap,ao){var e=ao.split("#"),an=e.length,ak="",am,al;for(al=1;al<an;al++){switch(e[al]){case"D":am=ap.getDate();break;case"DD":am=ap.getDate();am=i(am,2);break;case"WD":am=ap.getDay();break;case"WKD":am=X.dateNames.weekdShort[ap.getDay()];break;case"WEEKDAY":am=X.dateNames.weekdLong[ap.getDay()];break;case"M":am=ap.getMonth()+1;break;case"MM":am=ap.getMonth()+1;am=i(am,2);break;case"MON":am=X.dateNames.monthsShort[ap.getMonth()];break;case"MONTH":am=X.dateNames.monthsLong[ap.getMonth()];break;case"YY":am=ap.getYear();while(am>100){am-=100}break;case"YYYY":am=ap.getFullYear();break;case"h":am=ap.getHours();break;case"hh":am=ap.getHours();am=i(am,2);break;case"m":am=ap.getMinutes();break;case"mm":am=ap.getMinutes();am=i(am,2);break;case"s":am=ap.getSeconds();break;case"ss":am=ap.getSeconds();am=i(am,2);break;case"ms":am=ap.getMilliseconds();break;case"msmsms":am=ap.getMilliseconds();am=i(am,3);break;default:am=e[al];break}ak=ak+am}return ak}function H(ap,ao){var e=ao.split("#"),an=e.length,ak="",am,al;for(al=1;al<an;al++){switch(e[al]){case"d":if(an<=2){am=ap/86400000}else{am=Math.floor(ap/86400000);ap=ap%86400000}break;case"dd":if(an<=2){am=ap/86400000}else{am=Math.floor(ap/86400000);ap=ap%86400000}am=i(am,2);break;case"h":if(an<=2){am=ap/3600000}else{am=Math.floor(ap/3600000);ap=ap%3600000}break;case"hh":if(an<=2){am=ap/3600000}else{am=Math.floor(ap/3600000);ap=ap%3600000}am=i(am,2);break;case"m":if(an<=2){am=ap/60000}else{am=Math.floor(ap/60000);ap=ap%60000}break;case"mm":if(an<=2){am=ap/60000}else{am=Math.floor(ap/60000);ap=ap%60000}am=i(am,2);break;case"s":if(an<=2){am=ap/1000}else{am=Math.floor(ap/1000);ap=ap%1000}break;case"ss":if(an<=2){am=ap/1000}else{am=Math.floor(ap/1000);ap=ap%1000}am=i(am,2);break;case"ms":am=ap;break;case"msmsms":am=ap;am=i(am,3);break;default:am=e[al];break}ak=ak+am}return ak}function Q(ak){var e=s(ak.charCodeAt(0));return parseInt(e,16)}function ae(e){var ak=Q(e);if(ak>127){ak=ak-256}return ak}function M(ak){var e=s(ak.charCodeAt(1));e+=s(ak.charCodeAt(0));return parseInt(e,16)}function L(e){var ak=M(e);if(ak>32767){ak=ak-65536}return ak}function F(ak){var e=s(ak.charCodeAt(3));e+=s(ak.charCodeAt(2));e+=s(ak.charCodeAt(1));e+=s(ak.charCodeAt(0));return parseInt(e,16)}function O(e){var ak=F(e);if(ak>2147483647){ak=ak-4294967296}return ak}function V(e,al){var ak=F(e);if(al===undefined){return ak}return(H(ak,al))}function n(e,al){var ak=new Date(F(e));ak=new Date(ak.getTime()+ak.getTimezoneOffset()*60000);if(al===undefined){return ak}return(aj(ak,al))}function ac(ak,al){var e=new Date(F(ak)*1000);e=new Date(e.getTime()+e.getTimezoneOffset()*60000);if(al===undefined){return e}return(aj(e,al))}function q(al){var an=1,ap=0.5,ak=F(al),e,ao,am;if(ak===0){return 0}e=((ak>>>31)===1)?"-":"+";ak<<=1;ao=(ak>>>24)-127;ak<<=8;for(am=1;am<=23;am++){an+=ak<0?ap:0;ak<<=1;ap/=2}return parseFloat(e+(an*Math.pow(2,ao)))}function E(al){var ak=F(al.substring(4,8)),ao=F(al.substring(0,4)),an=12,am=1,aq=0.5,e,ap;if(ak===0&&ao===0){return 0}e=((ak>>>31)===1)?"-":"+";ak<<=1;ap=(ak>>>21)-1023;ak<<=11;while(an<32){am+=ak<0?aq:0;ak<<=1;aq/=2;an++}if((ao>>>31)===1){am+=aq;ao<<=1;aq/=2}while(an<64){am+=ao<0?aq:0;ao<<=1;aq/=2;an++}return parseFloat(e+(am*Math.pow(2,ap)))}function aa(e){return e.split(String.fromCharCode(0))[0]}function P(am){var an=p,ap=0,e="",ao,al,ak,au,at,ar,aq;am=am.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{au=an[am.charAt(ap++)];at=an[am.charAt(ap++)];ar=an[am.charAt(ap++)];aq=an[am.charAt(ap++)];ao=(au<<2)|(at>>4);al=((at&15)<<4)|(ar>>2);ak=((ar&3)<<6)|aq;e+=String.fromCharCode(ao);if(ar!==64){e+=String.fromCharCode(al)}if(aq!==64){e+=String.fromCharCode(ak)}}while(ap<am.length);return e}function T(ak,e,am){var al;switch(e){case"BOOL":al=(ak.charCodeAt(0)!="0");break;case"BYTE":case"USINT":al=Q(ak);break;case"SINT":al=ae(ak);break;case"WORD":case"UINT":al=M(ak);break;case"INT":case"INT16":al=L(ak);break;case"INT1DP":al=((L(ak))/10).toFixed(1);break;case"DWORD":case"UDINT":al=F(ak);break;case"DINT":al=O(ak);break;case"REAL":al=q(ak);if(am!==undefined){al=al.toFixed(parseInt(am,10))}break;case"LREAL":al=E(ak);if(am!==undefined){al=al.toFixed(parseInt(am,10))}break;case"STRING":al=aa(ak);break;case"TOD":case"TIME_OF_DAY":al=n(ak,am);break;case"TIME":al=V(ak,am);break;case"DT":case"DATE":case"DATE_AND_TIME":al=ac(ak,am);break;case"EndStruct":break;default:k("TAME library error: Unknown data type at parsing read request: "+e);break}return al}function v(aD){var ak,av=aD.reqDescr.items,at=[],aw=0,aA,am,an,aC,aq,ay,ar,aB,al,ax,au,ao,ap;try{ak=aD.xmlHttpReq.responseXML.documentElement;am=P(ak.getElementsByTagName("ppData")[0].firstChild.data);for(au=0,ao=av.length;au<ao;au++){aA=av[au];at=af(aA);al=at[0];ax=at[1];ay=z[al];switch(al){case"STRING":if(ax!==undefined){aq=parseInt(ax,10)}ay=(ai(aq)?aq:ay)+1;break;case"EndStruct":ay=aA.val;break}ar=ay<a?ay:a;if(aD.reqDescr.seq!==true){ap=j(aD.reqDescr);aw=aA.addr-ap}else{if(aD.reqDescr.calcAlignment===true&&ar>1&&al!=="EndStruct"&&al!=="STRING"&&aw>0){aB=aw%ar;if(aB>0){aw+=ar-aB}}}an=am.substr(aw,ay);aC=T(an,al,ax);if(al!=="EndStruct"){y(aA.jvar,aC,aD.reqDescr.dataObj,aA.prefix,aA.suffix)}if(aD.reqDescr.seq===true){aw+=ay}}}catch(az){k("TAME library error: Parsing of Read Request failed:"+az);k(aA);return}}function c(aJ){var ak,ax=aJ.reqDescr.items,av=[],aB=0,am=0,az=window,aG=0,aF,ao,ap,aI,aD,an,aC,aw,at,aq,ay,aA,au,ar;function al(){var aK,e;if(an==="STRING"){if(aC!==undefined){aK=parseInt(aC,10)}else{if(typeof N[aF.name].stringLength==="number"){aK=N[aF.name].stringLength}}aD=(ai(aK)?aK:aD)+1}e=ap.substr(am,aD);aI=T(e,an,aC);y(ay,aI,az,aF.prefix,aF.suffix);am+=aD}function aH(){var aL,aK,aP,aO,aM,aN;function e(){var aR,aQ;if(a>1&&an!=="STRING"&&an!=="EndStruct"){aR=aD<a?aD:a;if(aR>1&&am>0){aQ=am%aR;if(aQ>0){am+=aR-aQ}}if(aR>aG){aG=aR}}}for(aN in aF.def){if(aF.def.hasOwnProperty(aN)){aK=aF.def[aN].split(".");if(aK[0]==="ARRAY"){aP=parseInt(aK[1],10);aO=aK.length-1;for(aL=0;aL<aP;aL++){an=aK[2];if(aK[aO]==="SP"){ay=aN+aL;if(aO>=4){aC=aK.slice(3,-1).join(".")}}else{ay=aN+"."+aL;if(aO>=3){aC=aK.slice(3).join(".")}}if(aA!==null){ay=aA+"."+ay}aD=z[an];e();al()}}else{if(aA!==null){ay=aA+"."+aN}else{ay=aN}an=aK[0];aC=aK.slice(1).join(".");aD=z[an];e();al()}}}if(a>1&&aG>1&&an!=="STRING"&&an!=="EndStruct"){if(aG>a){aG=a}aM=am%aG;if(aM>0){am+=aG-aM}}}try{ak=aJ.xmlHttpReq.responseXML.documentElement;ao=P(ak.getElementsByTagName("ppRdData")[0].firstChild.data);for(aw=0,at=ax.length;aw<at;aw++){ap=ao.substr(aB,4);aq=T(ap,"DWORD");if(aq!==0){k("TAME library error: ADS sub command error while processing a SumReadRequest!");k("Error code: "+aq);k(ax[aw])}aB+=4}for(aw=0;aw<at;aw++){aF=ax[aw];av=af(aF);an=av[0];aC=av[1];ar=N[aF.name].size;aA=null;ap=ao.substr(aB,ar);switch(an){case"ARRAY":az=y(aF.jvar);am=0;au=N[aF.name].arrayLength;if(N[aF.name].arrayDataType==="USER"){for(aA=0;aA<au;aA++){aH()}}else{an=N[aF.name].arrayDataType;aD=z[an];for(aA=0;aA<au;aA++){ay=aA;al()}}break;case"USER":az=y(aF.jvar);am=0;aH();break;default:az=window;aI=T(ap,an,aC);y(aF.jvar,aI,az,aF.prefix,aF.suffix)}aB+=ar}}catch(aE){k("TAME library error: Parsing of SumReadRequest failed:"+aE);k(aF);return}}function w(aC){var ak,au=aC.reqDescr.items,ar=[],aw=0,al=0,av=window,aA,an,ao,aB,ay,am,ax,at,aq,ap;try{ak=aC.xmlHttpReq.responseXML.documentElement;an=P(ak.getElementsByTagName("ppRdData")[0].firstChild.data);for(at=0,aq=au.length;at<aq;at++){ao=an.substr(aw,4);ap=T(ao,"DWORD");if(ap!==0){k("TAME library error: ADS sub command error while processing a SumReadRequest!");k("Error code: "+ap);k(au[at])}aw+=4}}catch(az){k("TAME library error: Parsing of SumWriteRequest failed:"+az);k(aA);return}}function ag(am){var ak;try{ak=am.xmlHttpReq.responseXML.documentElement;X.adsState=parseInt(ak.getElementsByTagName("pAdsState")[0].firstChild.data,10);X.adsStateTxt=R[X.adsState];X.deviceState=parseInt(ak.getElementsByTagName("pDeviceState")[0].firstChild.data,10)}catch(al){k("TAME library error: Parsing of ADS Read State Request failed:"+al);return}}function K(aq,ao,am){var al={},an,ak;ak=z[ao];if(typeof am.name==="string"){am.name=am.name.toUpperCase()}switch(ao){case"STRING":if(ai(am.strlen)){ao+="."+am.strlen;ak=am.strlen}else{if(h===true){try{ak=N[am.name].stringLength;ao+="."+ak}catch(ap){k("TAME library error: A problem occured while reading the string length from the symbol table!");k(ap)}}}ak++;break;case"TIME":case"TOD":case"DT":case"DATE":case"DATE_AND_TIME":case"TIME_OF_DAY":if(typeof am.format==="string"){ao+="."+am.format}break;case"REAL":case"LREAL":if(typeof am.decPlaces==="number"){ao+="."+am.decPlaces}else{if(typeof am.dp==="number"){ao+="."+am.dp}}break}al={addr:am.addr,name:am.name,id:am.id,oc:am.oc,ocd:am.ocd,readLength:ak,debug:am.debug,sync:am.sync,bitOffset:am.offs,seq:true,items:[{val:am.val,jvar:am.jvar,type:ao,prefix:am.prefix,suffix:am.suffix}]};if(aq==="Write"){X.writeReq(al)}else{X.readReq(al)}}function G(an,ao,am){var ap={},aB={},aw,al,aD=0,aE=0,aC=0,aF,ak=[],aI,ar,av=0,ax,at,aH=0,ay=0,aK,au,aJ,az;if(typeof am.name==="string"){am.name=am.name.toUpperCase()}if(an==="Write"&&typeof am.val==="object"){aB=am.val}else{if(typeof am.jvar==="string"){aB=y(am.jvar)}else{k("TAME library error: No data object for this "+an+"-Request defined!")}}if(typeof am.arrlen==="number"){aw=am.arrlen}else{if(h===true){try{aw=N[am.name].arrayLength}catch(aG){k("TAME library error: A proble occured while reading the array length from the symbol table!");k(aG)}}else{k("TAME library error: Can't get the array length for this request!")}}if(typeof am.item==="number"&&!isNaN(am.item)&&an==="Write"){aJ=true;if(am.item<0||am.item>aw-1){k('TAME library error: Wrong value for "item"!');k("item: "+am.item);k("Last array index: "+(aw-1))}}function aq(){var e;if(typeof am.def==="string"){am.def=y(am.def)}else{if(typeof am.def!=="object"){k("TAME library error: No structure definition found!")}}for(e in am.def){if(am.def.hasOwnProperty(e)){ak=am.def[e].split(".");if(ak[0]==="ARRAY"){aI=parseInt(ak[1],10);ak.shift();ak.shift()}else{aI=1}for(aE=0;aE<aI;aE++){if(ak[0]==="STRING"){if(typeof ak[1]==="string"){ax=parseInt(ak[1],10)}at=(ai(ax)?ax:z[ak[0]])+1}else{at=z[ak[0]]}if(a>1&&at>1&&ak[0]!=="STRING"&&av>0){aK=av%at;if(aK>0){av+=at-aK}}av+=at}if(a>1&&at>aH&&ak[0]!=="STRING"){aH=at}}}if(a>1&&aH>1&&ak[0]!=="STRING"){if(aH>a){aH=a}aK=av%aH;if(aK>0){ay=aH-aK;av+=ay}}if(aJ){al=av*am.item;aw=1}ap={addr:am.addr,name:am.name,addrOffset:al,id:am.id,oc:am.oc,ocd:am.ocd,debug:am.debug,readLength:av*aw,seq:true,calcAlignment:true,dataObj:aB,sync:am.sync,bitOffset:am.offs,items:[]};for(aE=0;aE<aw;aE++){for(e in am.def){if(am.def.hasOwnProperty(e)){ak=am.def[e].split(".");if(ak[0]==="ARRAY"){aI=parseInt(ak[1],10);ar=ak.length-1;for(aC=0;aC<aI;aC++){if(ak[ar]==="SP"){ap.items[aD]={jvar:aE+"."+e+aC};if(ar===4){ap.items[aD].type=ak[2]+"."+ak[3]}else{ap.items[aD].type=ak[2]}}else{ap.items[aD]={jvar:aE+"."+e+"."+aC};if(ar===3){ap.items[aD].type=ak[2]+"."+ak[3]}else{ap.items[aD].type=ak[2]}}if(an==="Write"){if(aJ){if(ak[ar]==="SP"){ap.items[aD].val=aB[am.item][e+aC]}else{ap.items[aD].val=aB[am.item][e][aC]}}else{if(ak[ar]==="SP"){ap.items[aD].val=aB[aE][e+aC]}else{ap.items[aD].val=aB[aE][e][aC]}}}aD++}}else{ap.items[aD]={jvar:aE+"."+e,type:am.def[e]};if(an==="Write"){if(aJ){ap.items[aD].val=aB[am.item][e]}else{ap.items[aD].val=aB[aE][e]}}aD++}}}if(a>1){ap.items[aD]={type:"EndStruct",val:ay};aD++}}}function aA(){aF=z[ao];switch(ao){case"STRING":if(ai(am.strlen)){ao+="."+am.strlen;aF=am.strlen}else{if(h===true){aF=N[am.name].stringLength;ao+="."+aF}}aF++;break;case"TIME":case"TOD":case"DT":case"DATE":case"DATE_AND_TIME":case"TIME_OF_DAY":if(typeof am.format==="string"){ao+="."+am.format}break;case"REAL":case"LREAL":if(typeof am.decPlaces==="number"){ao+="."+am.decPlaces}else{if(typeof am.dp==="number"){ao+="."+am.dp}}break}if(aJ){al=am.item*aF;aw=1}ap={addr:am.addr,name:am.name,addrOffset:al,id:am.id,oc:am.oc,ocd:am.ocd,readLength:aF*aw,debug:am.debug,seq:true,dataObj:aB,items:[]};for(aE=0;aE<aw;aE++){ap.items[aE]={jvar:aE,type:ao};if(an==="Write"){if(aJ){ap.items[aE].val=aB[am.item]}else{ap.items[aE].val=aB[aE]}}}}if(ao==="STRUCT"){aq()}else{aA()}if(an==="Write"){X.writeReq(ap)}else{X.readReq(ap)}}function Z(e,ar){var ao={},ak={},at=[],am=0,aq,al,an,ap;if(typeof ar.name==="string"){ar.name=ar.name.toUpperCase()}if(e==="Write"&&typeof ar.val==="object"){ak=ar.val}else{if(typeof ar.jvar==="string"){ak=y(ar.jvar)}else{k("TAME library error: No data object for this "+e+"-Request defined!")}}if(typeof ar.def==="string"){ar.def=y(ar.def)}else{if(typeof ar.def!=="object"){k("TAME library error: No structure defininition found!")}}ao={addr:ar.addr,name:ar.name,id:ar.id,oc:ar.oc,ocd:ar.ocd,debug:ar.debug,seq:true,calcAlignment:true,dataObj:ak,sync:ar.sync,bitOffset:ar.offs,items:[]};for(an in ar.def){if(ar.def.hasOwnProperty(an)){at=ar.def[an].split(".");if(at[0]==="ARRAY"){al=parseInt(at[1],10);aq=at.length-1;for(ap=0;ap<al;ap++){if(at[aq]==="SP"){ao.items[am]={jvar:an+ap};if(aq===4){ao.items[am].type=at[2]+"."+at[3]}else{ao.items[am].type=at[2]}}else{ao.items[am]={jvar:an+"."+ap};if(aq===3){ao.items[am].type=at[2]+"."+at[3]}else{ao.items[am].type=at[2]}}if(e==="Write"){if(at[aq]==="SP"){ao.items[am].val=ak[an+ap]}else{ao.items[am].val=ak[an][ap]}}am++}}else{ao.items[am]={jvar:an,type:ar.def[an]};if(e==="Write"){ao.items[am].val=ak[an]}am++}}}if(e==="Write"){X.writeReq(ao)}else{X.readReq(ao)}}this.writeReq=function(am){var ao=am.items,aw={},e=[],ar=[],az=[],aq,av,al,ap,ak,ax,at,ay,an,au;if(typeof am.name==="string"){am.name=am.name.toUpperCase()}for(au=0,al=ao.length;au<al;au++){ay=ao[au];ar=af(ay);aq=ar[0];av=ar[1];if(isNaN(z[aq])){k("TAME library error: Could not get the length of the data type: "+aq);k("TAME library error: Probably wrong type definition. Please check the manual.");k(am);return}ap=(z[aq]<a)?z[aq]:a;if(am.calcAlignment===true&&ap>1&&aq!=="STRING"&&aq!=="EndStruct"&&e.length>0){at=e.length%ap;if(at>0){ax=ap-at;for(an=1;an<=ax;an++){e.push(0)}}}if(aq==="EndStruct"){for(an=1;an<=ay.val;an++){e.push(0)}}else{az=d(ay,aq,av,z[aq]);e=e.concat(az)}}if(e&&e.length>0){e=o(e)}aw={method:"Write",indexGroup:x(am),indexOffset:j(am),pData:e,reqDescr:am};t(aw).send()};this.readReq=function(al){var au={},am=al.items,ao=[],av,at,an,e,ap,aq,aw,ar,ak;if(typeof al.name==="string"){al.name=al.name.toUpperCase()}if(typeof al.readLength!=="number"){al.readLength=0;for(ar=0,e=am.length;ar<e;ar++){av=am[ar];ao=af(av);an=ao[0];at=ao[1];if(isNaN(z[an])){k("TAME library error: Could not get the length of the data type: "+an);k("TAME library error: Probably wrong type definition. Please check the manual.");k(al);return}if(an==="STRING"){if(typeof at==="string"){aw=parseInt(at,10)}aq=(ai(aw)?aw:z[an])+1}else{aq=z[an]}if(al.seq===true){if(al.calcAlignment===true&&aq>1&&an!=="EndStruct"&&an!=="STRING"&&al.readLength>0){ap=al.readLength%aq;if(ap>0){al.readLength+=aq-ap}}al.readLength+=aq}else{ak=j(al);al.readLength=aq+av.addr-ak}}}au={method:"Read",indexGroup:x(al),indexOffset:j(al),reqDescr:al};t(au).send()};this.sumReadReq=function(al){var au={},an=al.items,aq=[],aw=[],ax=[],ak=an.length,am={},ap,at,av,ar,ao,e;al.readLength=ak*4;for(ar=0;ar<ak;ar++){av=an[ar];if(typeof av.name==="string"){av.name=av.name.toUpperCase()}aq=af(av);ap=aq[0];at=aq[1];ao=N[av.name].size;al.readLength+=ao;if(av.offs!==undefined){av.bitOffset=av.offs}am.val=x(av);ax=d(am,"UDINT",at,4);aw=aw.concat(ax);am.val=j(av);ax=d(am,"UDINT",at,4);aw=aw.concat(ax);am.val=ao;ax=d(am,"UDINT",at,4);aw=aw.concat(ax)}if(aw.length>0){e=o(aw)}au={method:"ReadWrite",indexGroup:l.SumRd,indexOffset:an.length,pwrData:e,reqDescr:al};t(au).send()};this.sumWriteReq=function(am){var aF={},at=am.items,ap=[],ak=[],ar=[],an=at.length,aC={},aA=0,al,ax,az,aq,ay,aE,aw,av,ao,aB,e;function au(){var aG;ay=z[al];if(al==="STRING"){if(ax!==undefined){aG=parseInt(ax,10)}else{if(typeof N[az.name].stringLength==="number"){aG=N[az.name].stringLength}}ax=(ai(aG)?aG:ay)}}function aD(){var aJ,aO,aG,aK,aM,aH,aI=[];function aN(){var aQ,aP;if(a>1&&al!=="STRING"&&al!=="EndStruct"){aQ=ay<a?ay:a;if(aQ>1&&aI.length>0){aM=aI.length%aQ;if(aM>0){e=aQ-aM;for(aP=1;aP<=e;aP++){aI.push(0)}}}if(aQ>aA){aA=aQ}}}for(aH in az.def){if(az.def.hasOwnProperty(aH)){try{aO=az.def[aH].split(".");if(aO[0]==="ARRAY"){aG=parseInt(aO[1],10);aK=aO.length-1;for(aJ=0;aJ<aG;aJ++){al=aO[2];if(aO[aK]==="SP"){if(aK>=4){ax=aO.slice(3,-1).join(".")}}else{if(aK>=3){ax=aO.slice(3).join(".")}}if(aw!==null){if(aO[aK]==="SP"){aC.val=az.val[aw][aH+aJ]}else{aC.val=az.val[aw][aH][aJ]}}else{aC.val=az.val[aH][aJ]}au();aN();ar=d(aC,al,ax,ay);aI=aI.concat(ar)}}else{if(aw!==null){aC.val=az.val[aw][aH]}else{aC.val=az.val[aH]}al=aO[0];ax=aO.slice(1).join(".");au();aN();ar=d(aC,al,ax,ay);aI=aI.concat(ar)}}catch(aL){k("TAME library error: Could not set values for a structure in SumWriteReq: "+aL);k(az)}}}if(a>1&&aA>1&&aO[0]!=="STRING"&&aO[0]!=="EndStruct"){aM=aI.length%aA;if(aM>0){e=aA-aM;for(av=1;av<=e;av++){aI.push(0)}}}ak=ak.concat(aI)}am.readLength=an*4;for(aq=0;aq<an;aq++){az=at[aq];if(typeof az.name==="string"){az.name=az.name.toUpperCase()}ap=af(az);al=ap[0];ax=ap[1];ay=N[az.name].size;if(az.offs!==undefined){az.bitOffset=az.offs}aC.val=x(az);ar=d(aC,"UDINT",ax,4);ak=ak.concat(ar);aC.val=j(az);ar=d(aC,"UDINT",ax,4);ak=ak.concat(ar);aC.val=ay;ar=d(aC,"UDINT",ax,4);ak=ak.concat(ar)}for(aq=0;aq<an;aq++){az=at[aq];if(typeof az.name==="string"){az.name=az.name.toUpperCase()}ap=af(az);al=ap[0];ax=ap[1];ay=N[az.name].size;aw=null;switch(al){case"ARRAY":ao=parseInt(N[az.name].arrayLength,10);if(ao!==az.val.length){k("TAME library error: Array length in JS differs from the length in the PLC!");k("Length in JS: "+az.val.length);k("Length in PLC: "+ao);k(az);return}if(N[az.name].arrayDataType==="USER"){for(aw=0;aw<ao;aw++){aD()}}else{al=N[az.name].arrayDataType;if(al==="STRING"){ax=N[az.name].stringLength}else{ay=N[az.name].itemSize}for(aw=0;aw<ao;aw++){aC.val=az.val[aw];ar=d(aC,al,ax,ay);ak=ak.concat(ar)}}break;case"USER":aD();break;default:if(al==="STRING"){ax=N[az.name].stringLength}else{ay=N[az.name].size}ar=d(az,al,ax,ay);ak=ak.concat(ar)}}if(ak.length>0){aE=o(ak)}aF={method:"ReadWrite",indexGroup:l.SumWr,indexOffset:at.length,pwrData:aE,reqDescr:am};t(aF).send()};this.readAdsState=function(e){var ak={method:"ReadState",reqDescr:e};t(ak).send()};this.logSymbols=function(){k(N)};this.getSymbolsAsJSON=function(){var al;if(typeof JSON!=="object"){k("TAME library error: No JSON parser found.")}else{try{al=JSON.stringify(N);return al}catch(ak){k("TAME library error: Could not convert the Symbol Table to JSON:"+ak)}}};this.setSymbolsFromJSON=function(al){if(typeof JSON!=="object"){k("TAME library error: No JSON parser found.")}else{try{N=JSON.parse(al)}catch(ak){k("TAME library error: Could not create the Symbol Table from JSON:"+ak);return}h=true;k("TAME library info: Symbol Table successfully created from JSON data.")}};this.parseResponse=function(ap){var al,ao,ak;if(typeof ap.reqDescr.id==="number"){D[ap.reqDescr.id]=0}if(ap.xmlHttpReq.responseXML===null){k('TAME library error: Request contains no XML data. Object "responseXML" is null.');k('TAME library error: This is the "responseText":');k(ap.xmlHttpReq.responseText)}try{al=ap.xmlHttpReq.responseXML.documentElement}catch(an){k("TAME library error: No XML data in server response:"+an);return}try{ak=al.getElementsByTagName("faultstring")[0].firstChild.data;try{ao=al.getElementsByTagName("errorcode")[0].firstChild.data}catch(an){ao="-"}k("TAME library error: Message from server:  "+ak+" ("+ao+")");return}catch(am){ao=0}if(typeof al.normalize==="function"){al.normalize()}if(ap.method==="ReadState"){ag(ap)}else{if(ap.method==="Read"||ap.method==="ReadWrite"){switch(ap.indexGroup){case l.UploadInfo:U(ap);break;case l.Upload:ab(ap);break;case l.SumRd:c(ap);break;case l.SumWr:w(ap);break;default:v(ap)}}}if(typeof ap.reqDescr.oc==="function"){if(typeof ap.reqDescr.ocd==="number"){window.setTimeout(ap.reqDescr.oc,ap.reqDescr.ocd)}else{ap.reqDescr.oc()}}};this.writeBool=function(e){K("Write","BOOL",e)};this.writeByte=function(e){K("Write","BYTE",e)};this.writeUsint=function(e){K("Write","USINT",e)};this.writeSint=function(e){K("Write","SINT",e)};this.writeWord=function(e){K("Write","WORD",e)};this.writeUint=function(e){K("Write","UINT",e)};this.writeInt=function(e){K("Write","INT",e)};this.writeInt1Dp=function(e){K("Write","INT1DP",e)};this.writeDword=function(e){K("Write","DWORD",e)};this.writeUdint=function(e){K("Write","UDINT",e)};this.writeDint=function(e){K("Write","DINT",e)};this.writeReal=function(e){K("Write","REAL",e)};this.writeLreal=function(e){K("Write","LREAL",e)};this.writeString=function(e){K("Write","STRING",e)};this.writeTime=function(e){K("Write","TIME",e)};this.writeTod=function(e){K("Write","TOD",e)};this.writeDate=function(e){K("Write","DATE",e)};this.writeDt=function(e){K("Write","DT",e)};this.readBool=function(e){K("Read","BOOL",e)};this.readByte=function(e){K("Read","BYTE",e)};this.readUsint=function(e){K("Read","USINT",e)};this.readSint=function(e){K("Read","SINT",e)};this.readWord=function(e){K("Read","WORD",e)};this.readUint=function(e){K("Read","UINT",e)};this.readInt=function(e){K("Read","INT",e)};this.readInt1Dp=function(e){K("Read","INT1DP",e)};this.readDword=function(e){K("Read","DWORD",e)};this.readUdint=function(e){K("Read","UDINT",e)};this.readDint=function(e){K("Read","DINT",e)};this.readReal=function(e){K("Read","REAL",e)};this.readLreal=function(e){K("Read","LREAL",e)};this.readString=function(e){K("Read","STRING",e)};this.readTime=function(e){K("Read","TIME",e)};this.readTod=function(e){K("Read","TOD",e)};this.readDate=function(e){K("Read","DATE",e)};this.readDt=function(e){K("Read","DT",e)};this.writeStruct=function(e){Z("Write",e)};this.readStruct=function(e){Z("Read",e)};this.writeArrayOfBool=function(e){G("Write","BOOL",e)};this.writeArrayOfByte=function(e){G("Write","BYTE",e)};this.writeArrayOfUsint=function(e){G("Write","USINT",e)};this.writeArrayOfSint=function(e){G("Write","SINT",e)};this.writeArrayOfWord=function(e){G("Write","WORD",e)};this.writeArrayOfUint=function(e){G("Write","UINT",e)};this.writeArrayOfInt=function(e){G("Write","INT",e)};this.writeArrayOfInt1Dp=function(e){G("Write","INT1DP",e)};this.writeArrayOfDword=function(e){G("Write","DWORD",e)};this.writeArrayOfUdint=function(e){G("Write","UDINT",e)};this.writeArrayOfDint=function(e){G("Write","DINT",e)};this.writeArrayOfReal=function(e){G("Write","REAL",e)};this.writeArrayOfLreal=function(e){G("Write","LREAL",e)};this.writeArrayOfString=function(e){G("Write","STRING",e)};this.writeArrayOfTime=function(e){G("Write","TIME",e)};this.writeArrayOfTod=function(e){G("Write","TOD",e)};this.writeArrayOfDate=function(e){G("Write","DATE",e)};this.writeArrayOfDt=function(e){G("Write","DT",e)};this.writeArrayOfStruct=function(e){G("Write","STRUCT",e)};this.readArrayOfBool=function(e){G("Read","BOOL",e)};this.readArrayOfByte=function(e){G("Read","BYTE",e)};this.readArrayOfUsint=function(e){G("Read","USINT",e)};this.readArrayOfSint=function(e){G("Read","SINT",e)};this.readArrayOfWord=function(e){G("Read","WORD",e)};this.readArrayOfUint=function(e){G("Read","UINT",e)};this.readArrayOfInt=function(e){G("Read","INT",e)};this.readArrayOfInt1Dp=function(e){G("Read","INT1DP",e)};this.readArrayOfDword=function(e){G("Read","DWORD",e)};this.readArrayOfUdint=function(e){G("Read","UDINT",e)};this.readArrayOfDint=function(e){G("Read","DINT",e)};this.readArrayOfReal=function(e){G("Read","REAL",e)};this.readArrayOfLreal=function(e){G("Read","LREAL",e)};this.readArrayOfString=function(e){G("Read","STRING",e)};this.readArrayOfTime=function(e){G("Read","TIME",e)};this.readArrayOfTod=function(e){G("Read","TOD",e)};this.readArrayOfDate=function(e){G("Read","DATE",e)};this.readArrayOfDt=function(e){G("Read","DT",e)};this.readArrayOfStruct=function(e){G("Read","STRUCT",e)};function Y(){var e={method:"Read",sync:true,indexGroup:l.UploadInfo,indexOffset:0,reqDescr:{readLength:8}};t(e).send()}function U(ap){var ak,al,aq,an,am;try{ak=ap.xmlHttpReq.responseXML.documentElement;al=P(ak.getElementsByTagName("ppData")[0].firstChild.data);aq=al.substr(0,4);b=T(aq,"DWORD");aq=al.substr(4,4);u=T(aq,"DWORD")}catch(ao){k("TAME library error: Parsing of UploadInfo failed:"+ao);return}am={method:"Read",sync:true,indexGroup:l.Upload,indexOffset:0,reqDescr:{readLength:u}};t(am).send()}function ab(aC){var ak,au=0,az=4,aw=8,ar=12,ao=30,an,ap,aB,at,av,al,aA,aq,am,ay;try{ak=aC.xmlHttpReq.responseXML.documentElement;an=P(ak.getElementsByTagName("ppData")[0].firstChild.data);for(at=0;at<b;at++){ap=an.substr(au,4);av=T(ap,"DWORD");al=an.substring(au+ao,(au+av)).split(String.fromCharCode(0));name=al[0].toUpperCase();N[name]={typeString:al[1],indexGroup:T(an.substr(au+az,4),"DWORD"),indexOffset:T(an.substr(au+aw,4),"DWORD"),size:T(an.substr(au+ar,4),"DWORD")};aA=al[1].split(" ");if(aA[0]==="ARRAY"){N[name].type=aA[0];aq=aA[1].substring(1,aA[1].length-1);aq=aq.split("..");aq=parseInt(aq[1],10)-parseInt(aq[0],10)+1;N[name].arrayLength=aq;am=aA[3].split("(");if(am[1]!==undefined){am[1]=am[1].substr(0,am[1].length-1);N[name].fullType=aA[0]+"."+aq+"."+am[0]+"."+am[1];N[name].stringLength=parseInt(am[1],10)}else{N[name].fullType=aA[0]+"."+aq+"."+am[0]}N[name].itemSize=N[name].size/aq;N[name].arrayDataType="USER";for(ay in z){if(z.hasOwnProperty(ay)){if(am[0]===ay){N[name].arrayDataType=am[0]}}}}else{am=aA[0].split("(");if(am[1]!==undefined){am[1]=am[1].substr(0,am[1].length-1);N[name].fullType=am[0]+"."+am[1];N[name].stringLength=parseInt(am[1],10)}else{N[name].fullType=am[0]}N[name].type="USER";for(ay in z){if(z.hasOwnProperty(ay)){if(am[0]===ay){N[name].type=am[0]}}}}au+=av}h=true;k("TAME library info: End of fetching the symbols.");k("TAME library info: Symbol table ready.")}catch(ax){k("TAME library error: Parsing of uploaded symbol information failed:"+ax);return}}function B(){var am=W(),ap=[],au,ak,av,aq,an,at,al;am.open("GET",f.symFileUrl,false);am.setRequestHeader("Content-Type","text/xml");am.send(null);k("TAME library info: Start reading the TPY file.");if(typeof DOMParser=="function"){try{au=(new DOMParser()).parseFromString(am.responseText,"text/xml");av=au.getElementsByTagName("Symbols")[0];ap=av.getElementsByTagName("Symbol");for(var ao=0;ao<ap.length;ao++){ak=ap[ao].getElementsByTagName("Name")[0].childNodes[0].nodeValue.toUpperCase();N[ak]={typeString:ap[ao].getElementsByTagName("Type")[0].childNodes[0].nodeValue.toUpperCase(),indexGroup:parseInt(ap[ao].getElementsByTagName("IGroup")[0].childNodes[0].nodeValue,10),indexOffset:parseInt(ap[ao].getElementsByTagName("IOffset")[0].childNodes[0].nodeValue,10),bitSize:parseInt(ap[ao].getElementsByTagName("BitSize")[0].childNodes[0].nodeValue,10)};N[ak].size=(N[ak].bitSize>=8)?N[ak].bitSize/8:N[ak].bitSize;aq=N[ak].typeString.split(" ");if(aq[0]==="ARRAY"){N[ak].type=aq[0];an=aq[1].substring(1,aq[1].length-1);an=an.split("..");an=parseInt(an[1],10)-parseInt(an[0],10)+1;N[ak].arrayLength=an;at=aq[3].split("(");if(at[1]!==undefined){at[1]=at[1].substr(0,at[1].length-1);N[ak].fullType=aq[0]+"."+an+"."+at[0]+"."+at[1];N[ak].stringLength=parseInt(at[1],10)}else{N[ak].fullType=aq[0]+"."+an+"."+at[0]}N[ak].itemSize=N[ak].size/an;N[ak].arrayDataType="USER";for(al in z){if(z.hasOwnProperty(al)){if(at[0]===al){N[ak].arrayDataType=at[0]}}}}else{at=aq[0].split("(");if(at[1]!==undefined){at[1]=at[1].substr(0,at[1].length-1);N[ak].fullType=at[0]+"."+at[1];N[ak].stringLength=parseInt(at[1],10)}else{N[ak].fullType=at[0]}N[ak].type="USER";for(al in z){if(z.hasOwnProperty(al)){if(at[0]===al){N[ak].type=at[0]}}}}}h=true;k("TAME library info: End of reading the TPY file.");k("TAME library info: Symbol table ready.")}catch(ar){k("TAME library error: An error occured while parsing the symbol file:");k(ar)}}else{k("TAME library error: Can't parse the symbol file cause your brower does not provide a DOMParser function.")}}if(f.dontFetchSymbols===true){k("TAME library info: Reading of the UploadInfo deactivated. Symbol Table could not be created.")}else{if(typeof f.symFileUrl=="string"){k("TAME library message: Fetching the TPY file from the webserver.");B()}else{k("TAME library info: Start fetching the symbols from PLC.");try{Y()}catch(ah){k("TAME library error: Could'nt fetch the symbol information from the PLC:"+ah);return}}}};TAME.WebServiceClient.createClient=function(a){return new TAME.WebServiceClient(a)};