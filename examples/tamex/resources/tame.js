/*!
 * TAME [TwinCAT ADS Made Easy] V3.4
 * 
 * Copyright (c) 2009-2015 Thomas Schmidt; t.schmidt.p1 at freenet.de
 * 
 * Dual licensed under:
 *  MIT - http://www.opensource.org/licenses/mit-license
 *  GPLv3 - http://www.opensource.org/licenses/GPL-3.0
 * 
 */
var TAME={weekdShortNames:{ge:["So","Mo","Di","Mi","Do","Fr","Sa"],en:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},weekdLongNames:{ge:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],en:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},monthsShortNames:{ge:["Jan","Feb","Mrz","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],en:["Jan","Feb","Mar","Apr","May","Jun","July","Aug","Sept","Oct","Nov","Dez"]},monthsLongNames:{ge:["Januar","Februar","MÃ¤rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],en:["January","February","March","April","May","June","July","August","September","October","November","December"]}};TAME.WebServiceClient=function(f){function k(aj){try{window.console.log(aj)}catch(ak){alert(aj)}}var W=this,l={M:16416,MX:16417,I:61472,IX:61473,Q:61488,QX:61489,Upload:61451,UploadInfo:61452,SumRd:61568,SumWr:61569,SumRdWr:61570},z={BOOL:1,BYTE:1,USINT:1,SINT:1,WORD:2,UINT:2,INT:2,INT16:2,INT1DP:2,DWORD:4,UDINT:4,DINT:4,TIME:4,TOD:4,TIME_OF_DAY:4,DATE:4,DT:4,DATE_AND_TIME:4,POINTER:4,REAL:4,LREAL:8,STRING:80,EndStruct:0},Q=["INVALID","IDLE","RESET","INIT","START","RUN","STOP","SAVECFG","POWERGOOD","ERROR","SHUTDOWN","SUSPEND","RESUME","CONFIG","RECONFIG"],g=(typeof f.language==="string")?f.language:"ge",m=(function(){var e={},ak="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",aj;for(aj=0;aj<ak.length;aj++){e[aj]=ak.charAt(aj)}return e}()),p=(function(){var e={},ak="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",aj;for(aj=0;aj<ak.length;aj++){e[ak.charAt(aj)]=aj}return e}()),a=1,C=[0],M={},h=false,b=0,u=0;if(typeof f.serviceUrl!=="string"){k("TAME library error: Service URL is not a string!");return}if(typeof f.amsNetId!=="string"){k("TAME library error: NetId is not a string!");return}if(f.amsPort===undefined){f.amsPort="801";k("TAME library warning: AMS port number is not set! Default port 801 will be used.")}else{if(typeof f.amsPort==="number"){k("TAME library warning: AMS port number is not a string! Trying to convert it.");f.amsPort=f.amsPort.toString(10)}}if(parseInt(f.amsPort,10)<801||parseInt(f.amsPort,10)>891){k("TAME library error: AMS Port Number ("+parseInt(f.amsPort,10)+") is out of range (801-891)!");return}if(f.dataAlign4===true){a=4}else{if(f.alignment===undefined){a=1}else{if(typeof f.alignment==="string"){a=parseInt(f.alignment,10)}else{if(typeof f.alignment==="number"){a=f.alignment}}}}k("TAME library info: Data alignment set to: "+a);if(a!==1&&a!==4&&a!==8){k("TAME library warning: The value for the alignment should be 1, 4 or 8.")}if(f.syncXmlHttp===true){k('TAME library info: The "syncXmlHttp" parameter was set. Synchronous XMLHttpRequests are used by default.')}if(typeof f.serviceUser==="string"&&typeof f.servicePassword==="string"){k("TAME library info: Username and password set. Authenticated requests will be used.")}else{f.serviceUser=null;f.servicePassword=null}this.dateNames={weekdShort:TAME.weekdShortNames[g],weekdLong:TAME.weekdLongNames[g],monthsShort:TAME.monthsShortNames[g],monthsLong:TAME.monthsLongNames[g]};this.maxStringLen=255;this.maxDropReq=10;this.useCheckBounds=true;this.adsState=null;this.adsStateTxt="";this.deviceState=null;function y(e,al,ak,an,aq){var am=[],ap=0,ao=[],aj=0;if(typeof e==="number"){am[0]=e.toString(10)}else{if(typeof e==="string"){am=e.split(".")}else{k("TAME library error: Can't parse name of object/variable. Name is not a string or number!");k(e);return}}if(ak===undefined){ak=window}ap=am.length-1;while(aj<ap){if(am[aj].charAt(am[aj].length-1)==="]"){ao=am[aj].substring(0,am[aj].length-1).split("[");ak=ak[ao[0]][ao[1]]}else{if(ak[am[aj]]===undefined){ak[am[aj]]=[]}ak=ak[am[aj]]}aj++}if(am[aj].charAt(am[aj].length-1)==="]"){ao=am[aj].substring(0,am[aj].length-1).split("[");ak=ak[ao[0]];if(al!==undefined){if(typeof an==="string"){al=an+al}if(typeof aq==="string"){al=al+aq}ak[ao[1]]=al}return ak[ao[1]]}if(al!==undefined){if(typeof an==="string"){al=an+al}if(typeof aq==="string"){al=al+aq}ak[am[aj]]=al}return ak[am[aj]]}function ah(e){if(e===undefined){return false}if(!isNaN(e)&&e>0&&e<=W.maxStringLen){return true}k("TAME library error: User defined string length not valid! length: "+e);k("Max. string length: "+W.maxStringLen);return false}function x(ak){var aj;if(ak.addr){if(typeof ak.addr==="string"&&ak.addr.charAt(0)==="%"){if(ak.addr.charAt(2)==="X"){aj=l[ak.addr.substr(1,2)]}else{aj=l[ak.addr.substr(1,1)]}}else{k('TAME library error: Wrong address definition, should be a string and start with "%"!');k(ak);return}}else{if(ak.name){if(typeof ak.name==="string"){try{aj=M[ak.name].indexGroup}catch(al){k("TAME library error: Can't get the IndexGroup for this request!");k("TAME library error: Please check the variable name.");k(al);k(ak);return}}else{k("TAME library error: Varible name should be a string!");k(ak);return}}else{k("TAME library error: Neither a name nor an address for the variable/request defined!");k(ak);return}}if(isNaN(aj)){k("TAME library error: IndexGroup is not a number, check address or name definition of the variable/request!");k(ak)}return aj}function j(ak){var an,aj="",al=[];if(ak.addr){if(typeof ak.addr==="string"&&ak.addr.charAt(0)==="%"){if(ak.addr.charAt(2)==="X"){aj=ak.addr.substr(3);al=aj.split(".");an=parseInt(al[0],10)*8+parseInt(al[1],10)}else{an=parseInt(ak.addr.substr(3),10);if(typeof ak.addrOffset==="number"){an+=ak.addrOffset}}}else{k('TAME library error: Wrong address definition, should be a string and start with "%"!');k(ak);return}}else{if(ak.name){if(typeof ak.name==="string"){try{an=M[ak.name].indexOffset;if(typeof ak.addrOffset==="number"){an+=ak.addrOffset}}catch(am){k("TAME library error: Can't get the IndexOffset for this request!");k("TAME library error: Please check the variable name.");k(am);k(ak);return}}else{k("TAME library error: Varible name should be a string!");k(ak);return}}else{k("TAME library error: Neither a name nor an address for the variable/request defined!");k(ak);return}}if(isNaN(an)){k("TAME library error: IndexOffset is not a number, check address or name definition of the variable/request.");k(ak)}return an}function V(){var ak;if(window.XMLHttpRequest){ak=new window.XMLHttpRequest()}else{try{ak=new window.ActiveXObject("Msxml2.XMLHTTP")}catch(al){try{ak=new window.ActiveXObject("Microsoft.XMLHTTP")}catch(aj){ak=null;k("TAME library error: Failed Creating XMLHttpRequest-Object!")}}}return ak}function t(e){if(e.reqDescr===undefined){e.reqDescr={}}else{if(e.reqDescr.debug){k(e)}}e.send=function(){var aj,ak;if(typeof this.reqDescr.id==="number"&&C[this.reqDescr.id]>0){k("TAME library warning: Request dropped (last request with ID "+e.reqDescr.id+" not finished!)");C[this.reqDescr.id]++;if(C[this.reqDescr.id]<=W.maxDropReq){return}C[this.reqDescr.id]=0}if(e.sync===true){ak=false}else{if(this.reqDescr.sync===true){ak=false}else{if(this.reqDescr.sync===false){ak=true}else{if(f.syncXmlHttp===true){ak=false}else{ak=true}}}}this.xmlHttpReq=V();aj="<?xml version='1.0' encoding='utf-8'?>";aj+="<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' ";aj+="xmlns:xsd='http://www.w3.org/2001/XMLSchema' ";aj+="xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'>";aj+="<soap:Body><q1:";aj+=this.method;aj+=" xmlns:q1='http://beckhoff.org/message/'><netId xsi:type='xsd:string'>";aj+=f.amsNetId;aj+="</netId><nPort xsi:type='xsd:int'>";aj+=f.amsPort;aj+="</nPort>";if(this.indexGroup!==undefined){aj+="<indexGroup xsi:type='xsd:unsignedInt'>";aj+=this.indexGroup;aj+="</indexGroup>"}if(this.indexOffset!==undefined){aj+="<indexOffset xsi:type='xsd:unsignedInt'>";aj+=this.indexOffset;aj+="</indexOffset>"}if((this.method==="Read"||this.method==="ReadWrite")&&this.reqDescr.readLength>0){aj+="<cbRdLen xsi:type='xsd:int'>";aj+=this.reqDescr.readLength;aj+="</cbRdLen>"}if(this.pData&&this.pData.length>0){aj+="<pData xsi:type='xsd:base64Binary'>";aj+=this.pData;aj+="</pData>"}if(this.pwrData&&this.pwrData.length>0){aj+="<pwrData xsi:type='xsd:base64Binary'>";aj+=this.pwrData;aj+="</pwrData>"}aj+="</q1:";aj+=this.method;aj+="></soap:Body></soap:Envelope>";if(typeof this.xmlHttpReq==="object"){this.xmlHttpReq.open("POST",f.serviceUrl,ak,f.serviceUser,f.servicePassword);this.xmlHttpReq.setRequestHeader("SOAPAction","http://beckhoff.org/action/TcAdsSync."+this.method);this.xmlHttpReq.setRequestHeader("Content-Type","text/xml; charset=utf-8");if(ak===true){this.xmlHttpReq.onreadystatechange=function(){if((e.xmlHttpReq.readyState===4)&&(e.xmlHttpReq.status===200)){W.parseResponse(e)}};this.xmlHttpReq.send(aj)}else{this.xmlHttpReq.send(aj);W.parseResponse(e)}if(typeof this.reqDescr.id==="number"){C[this.reqDescr.id]=1}}};return e}function R(al,ak,aj,e){var am;if(typeof al.val==="string"){if(ak==="REAL"||ak==="LREAL"){am=parseFloat(al.val)}else{am=parseInt(al.val,10)}}else{if(typeof al.val==="number"){am=al.val}else{k("TAME library error: Wrong variable type for a numeric variable in write request!");k("TAME library error: Variable type should be number or string, but is "+typeof al.val);k(al);am=0}}if(isNaN(am)){am=0;k("TAME library error: Value of a numeric variable in write request is not a number.");k(al)}if(W.useCheckBounds===true){if(ak==="LREAL"){if(!isFinite(am)){k("TAME library warning: Limit for LREAL value exceeded!");k("Upper limit: "+Number.MAX_VALUE);k("Lower limit: "+Number.MIN_VALUE);k("value: "+am);k(al)}}else{if(ak==="REAL"){if(am>0){if(am<1.175495e-38){k("TAME library warning: Lower limit for positive REAL value exceeded!");k("limit: 1.175495e-38");k("value: "+am);k(al);am=1.175495e-38}else{if(am>3.402823e+38){k("TAME library warning: Upper limit for positive REAL value exceeded!");k("limit: 3.402823e+38");k("value: "+am);k(al);am=3.402823e+38}}}else{if(am<0){if(am>-1.175495e-38){k("TAME library warning: Upper limit for negative REAL value exceeded!");k("limit: -1.175495e-38");k("value: "+am);k(al);am=-1.175495e-38}else{if(am<-3.402823e+38){k("TAME library warning: Lower limit for negative REAL value exceeded!");k("limit: -3.402823e+38");k("value: "+am);k(al);am=-3.402823e+38}}}}}else{if(am<aj){k("TAME library warning: Lower limit for numeric value exceeded!");k("type: "+ak);k("limit: "+aj);k("value: "+am);k(al);am=aj}else{if(am>e){k("TAME library warning: Upper limit for numeric value exceeded!");k("type: "+ak);k("limit: "+e);k("value: "+am);k(al);am=e}}}}}return am}function ae(ak){var aj=[];if(typeof ak.type==="string"){aj=ak.type.split(".");if(aj.length>2){aj[1]=aj.slice(1).join(".")}}else{if(h&&typeof ak.name==="string"){try{aj[0]=M[ak.name].type;if(aj[0]==="STRING"){aj[1]=M[ak.name].stringLength}else{if(typeof ak.format==="string"){aj[1]=ak.format}else{if(typeof ak.decPlaces==="number"){aj[1]=ak.decPlaces}else{if(typeof ak.dp==="number"){aj[1]=ak.dp}}}}}catch(al){k("TAME library error: A problem occured while reading a data type from the symbol table!");k(al);k(ak)}}else{k("TAME library error: Could not get the type of the item!");k(ak)}}return aj}function H(e){if((e>=97)&&(e<=102)){return(e-87)}if((e>=65)&&(e<=70)){return(e-55)}if((e>=48)&&(e<=57)){return(e-48)}return 0}function ac(am,aj){var e=[],al=am.toString(16),ak;while(al.length<aj*2){al="0"+al}for(ak=0;ak<aj;ak++){e[(aj-1)-ak]=((H(al.charCodeAt(ak*2))*16)+H(al.charCodeAt((ak*2)+1)))}return e}function r(aj){var am=0,ap=0,an,e,al,ao,ak;e=Math.abs(aj);if(aj!==0){for(ak=128;ak>-127;ak--){al=e/Math.pow(2,ak);if(al>=2){break}ao=ak;an=al}ao+=127;an=an.toString(2);for(ak=2;ak<25;ak++){am<<=1;if(an.charAt(ak)==="1"){am+=1}}if(an.charAt(25)==="1"){am+=1}ap=ao;ap<<=23;ap+=am;if(aj<0){ap+=2147483648}}return ap}function B(ao){var ak=0,aq=0,al={part1:0,part2:0},ar,an,aj,e,ap,am;ar=Math.abs(ao);if(ao!==0){for(am=1024;am>=-1023;am--){an=ar/Math.pow(2,am);if(an>=2){break}aj=am;ap=an}aj+=1023;ap=ap.toString(2);for(am=2;am<22;am++){ak<<=1;if(ap.charAt(am)==="1"){ak+=1}}if(ap.charAt(am)==="1"){e=true}am++;for(am;am<54;am++){aq<<=1;if(ap.charAt(am)==="1"){aq+=1}}al.part1=aj;al.part1<<=20;al.part1+=ak;if(ao<0){al.part1+=2147483648}al.part2=aq;if(e===true){al.part2+=2147483648}}return al}function I(ak,aj){var e;switch(aj){case"#d":case"#dd":e=ak*86400000;break;case"#h":case"#hh":e=ak*3600000;break;case"#m":case"#mm":e=ak*60000;break;case"#s":case"#ss":e=ak*1000;break;case"#ms":case"#msmsms":e=ak;break;default:e=ak;break}return e}function A(ap,ar){var e=ar.split("#"),ao=e.length,aq=/:|\.|-|_/,ak=0,aj=0,am,al,an,at;for(al=1;al<ao;al++){if(aq.test(e[al])===true){at=true}}if(at!==true){k("TAME library error: No separator ( : . - _ ) for TOD string found!");k("String: "+ap);k("Format: "+ar);return 0}an=ap.split(aq);for(al=1;al<ao;al++){switch(e[al]){case"h":case"hh":am=parseInt(an[aj],10)*3600000;aj++;break;case"m":case"mm":am=parseInt(an[aj],10)*60000;aj++;break;case"s":case"ss":am=parseInt(an[aj],10)*1000;aj++;break;case"ms":case"msmsms":am=parseInt(an[aj],10);aj++;break;default:am=0}ak+=am}return ak}function o(ao){var an=m,al=0,aj="",am,ak,e;while(al<ao.length){am=ao[al++];ak=ao[al++];e=ao[al++];aj=aj+an[am>>2]+an[((am&3)<<4)|(ak>>4)]+(isNaN(ak)?"=":an[(((ak&15)<<2)|(e>>6))])+((isNaN(ak)||isNaN(e))?"=":an[e&63])}return aj}function d(ao,am,an,al){var aq=[],e,ap,aj,ak;if(ao.val===undefined){switch(am){case"STRING":ao.val="";break;case"DATE":case"DT":case"TOD":case"TIME_OF_DAY":case"DATE_AND_TIME":ao.val=new Date();break;default:ao.val=0;break}k("TAME library warning: Value of a variable in write request is not defined!");k(ao)}switch(am){case"BOOL":if(ao.val){aq[0]=1}else{aq[0]=0}break;case"BYTE":case"USINT":e=R(ao,am,0,255);aq=ac(e,al);break;case"SINT":e=R(ao,am,-128,127);if(e<0){e=e+256}aq=ac(e,al);break;case"WORD":case"UINT":e=R(ao,am,0,65535);aq=ac(e,al);break;case"INT":case"INT16":e=R(ao,am,-32768,32767);if(e<0){e=e+65536}aq=ac(e,al);break;case"INT1DP":ao.val=Math.round(ao.val*10);e=R(ao,am,-32768,32767);if(e<0){e=e+65536}aq=ac(e,al);break;case"DWORD":case"UDINT":e=R(ao,am,0,4294967295);aq=ac(e,al);break;case"DINT":e=R(ao,am,-2147483648,2147483647);if(e<0){e=e+4294967296}aq=ac(e,al);break;case"REAL":e=R(ao,am);e=r(e);aq=ac(e,al);break;case"LREAL":e=R(ao,am);e=B(e);aq=ac(e.part2,4);aq=aq.concat(ac(e.part1,4));break;case"DATE":if(typeof ao.val==="object"){ao.val.setHours(0);ao.val.setMinutes(0);ao.val.setSeconds(0);e=ao.val.getTime()/1000-ao.val.getTimezoneOffset()*60}else{k("TAME library error: Value of a DATE variable in write request is not a date object!");k(ao)}aq=ac(e,al);break;case"DT":case"DATE_AND_TIME":if(typeof ao.val==="object"){e=ao.val.getTime()/1000-ao.val.getTimezoneOffset()*60}else{k("TAME library error: Value of a DT variable in write request is not a date object!");k(ao)}aq=ac(e,al);break;case"TOD":case"TIME_OF_DAY":if(typeof ao.val==="object"){ao.val.setYear(1970);ao.val.setMonth(0);ao.val.setDate(1);e=ao.val.getTime()-ao.val.getTimezoneOffset()*60000}else{if(typeof ao.val==="string"){if(an===""||an===undefined){an="#hh#:#mm";k("TAME library warning: No format given for TOD string! Using default #hh#:#mm.");k(ao)}e=A(ao.val,an)}else{k("TAME library error: TOD value in write request is wether a date object nor a string!");k(ao)}}aq=ac(e,al);break;case"STRING":ap=(an===undefined)?z.STRING:parseInt(an,10);if(ah(ap)){aj=ap<ao.val.length?ap:ao.val.length;for(ak=0;ak<aj;ak++){aq[ak]=ao.val.charCodeAt(ak)}for(ak;ak<ap;ak++){aq[ak]=0}aq[ak]=0}break;case"TIME":e=parseInt(ao.val,10);if(isNaN(e)){k("TAME library warning: Value of a TIME variable in write request is not defined!");k(ao);e=0}e=I(e,an);if(e<0){e=0;k("TAME library warning: Lower limit for TIME variable in write request exceeded!)");k("value: "+ao.val+an);k(ao)}else{if(e>4294967295){e=4294967295;k("TAME library warning: Upper limit for TIME variable in write request exceeded!)");k("value: "+ao.val+an);k(ao)}}aq=ac(e,al);break;case"EndStruct":break;default:k("TAME library error: Unknown data type in write request : "+am);break}return aq}function s(aj){var e=aj.toString(16);if((e.length%2)!==0){e="0"+e}return e}function i(aj,e){e=(isNaN(e))?0:e;var ak=aj.toString(10);while(ak.length<e){ak="0"+ak}return ak}function ai(ao,an){var e=an.split("#"),am=e.length,aj="",al,ak;for(ak=1;ak<am;ak++){switch(e[ak]){case"D":al=ao.getDate();break;case"DD":al=ao.getDate();al=i(al,2);break;case"WD":al=ao.getDay();break;case"WKD":al=W.dateNames.weekdShort[ao.getDay()];break;case"WEEKDAY":al=W.dateNames.weekdLong[ao.getDay()];break;case"M":al=ao.getMonth()+1;break;case"MM":al=ao.getMonth()+1;al=i(al,2);break;case"MON":al=W.dateNames.monthsShort[ao.getMonth()];break;case"MONTH":al=W.dateNames.monthsLong[ao.getMonth()];break;case"YY":al=ao.getYear();while(al>100){al-=100}break;case"YYYY":al=ao.getFullYear();break;case"h":al=ao.getHours();break;case"hh":al=ao.getHours();al=i(al,2);break;case"m":al=ao.getMinutes();break;case"mm":al=ao.getMinutes();al=i(al,2);break;case"s":al=ao.getSeconds();break;case"ss":al=ao.getSeconds();al=i(al,2);break;case"ms":al=ao.getMilliseconds();break;case"msmsms":al=ao.getMilliseconds();al=i(al,3);break;default:al=e[ak];break}aj=aj+al}return aj}function G(ao,an){var e=an.split("#"),am=e.length,aj="",al,ak;for(ak=1;ak<am;ak++){switch(e[ak]){case"d":if(am<=2){al=ao/86400000}else{al=Math.floor(ao/86400000);ao=ao%86400000}break;case"dd":if(am<=2){al=ao/86400000}else{al=Math.floor(ao/86400000);ao=ao%86400000}al=i(al,2);break;case"h":if(am<=2){al=ao/3600000}else{al=Math.floor(ao/3600000);ao=ao%3600000}break;case"hh":if(am<=2){al=ao/3600000}else{al=Math.floor(ao/3600000);ao=ao%3600000}al=i(al,2);break;case"m":if(am<=2){al=ao/60000}else{al=Math.floor(ao/60000);ao=ao%60000}break;case"mm":if(am<=2){al=ao/60000}else{al=Math.floor(ao/60000);ao=ao%60000}al=i(al,2);break;case"s":if(am<=2){al=ao/1000}else{al=Math.floor(ao/1000);ao=ao%1000}break;case"ss":if(am<=2){al=ao/1000}else{al=Math.floor(ao/1000);ao=ao%1000}al=i(al,2);break;case"ms":al=ao;break;case"msmsms":al=ao;al=i(al,3);break;default:al=e[ak];break}aj=aj+al}return aj}function P(aj){var e=s(aj.charCodeAt(0));return parseInt(e,16)}function ad(e){var aj=P(e);if(aj>127){aj=aj-256}return aj}function L(aj){var e=s(aj.charCodeAt(1));e+=s(aj.charCodeAt(0));return parseInt(e,16)}function K(e){var aj=L(e);if(aj>32767){aj=aj-65536}return aj}function E(aj){var e=s(aj.charCodeAt(3));e+=s(aj.charCodeAt(2));e+=s(aj.charCodeAt(1));e+=s(aj.charCodeAt(0));return parseInt(e,16)}function N(e){var aj=E(e);if(aj>2147483647){aj=aj-4294967296}return aj}function U(e,ak){var aj=E(e);if(ak===undefined){return aj}return(G(aj,ak))}function n(e,ak){var aj=new Date(E(e));aj=new Date(aj.getTime()+aj.getTimezoneOffset()*60000);if(ak===undefined){return aj}return(ai(aj,ak))}function ab(aj,ak){var e=new Date(E(aj)*1000);e=new Date(e.getTime()+e.getTimezoneOffset()*60000);if(ak===undefined){return e}return(ai(e,ak))}function q(ak){var am=1,ao=0.5,aj=E(ak),e,an,al;if(aj===0){return 0}e=((aj>>>31)===1)?"-":"+";aj<<=1;an=(aj>>>24)-127;aj<<=8;for(al=1;al<=23;al++){am+=aj<0?ao:0;aj<<=1;ao/=2}return parseFloat(e+(am*Math.pow(2,an)))}function D(ak){var aj=E(ak.substring(4,8)),an=E(ak.substring(0,4)),am=12,al=1,ap=0.5,e,ao;if(aj===0&&an===0){return 0}e=((aj>>>31)===1)?"-":"+";aj<<=1;ao=(aj>>>21)-1023;aj<<=11;while(am<32){al+=aj<0?ap:0;aj<<=1;ap/=2;am++}if((an>>>31)===1){al+=ap;an<<=1;ap/=2}while(am<64){al+=an<0?ap:0;an<<=1;ap/=2;am++}return parseFloat(e+(al*Math.pow(2,ao)))}function Z(e){return e.split(String.fromCharCode(0))[0]}function O(al){var am=p,ao=0,e="",an,ak,aj,at,ar,aq,ap;al=al.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{at=am[al.charAt(ao++)];ar=am[al.charAt(ao++)];aq=am[al.charAt(ao++)];ap=am[al.charAt(ao++)];an=(at<<2)|(ar>>4);ak=((ar&15)<<4)|(aq>>2);aj=((aq&3)<<6)|ap;e+=String.fromCharCode(an);if(aq!==64){e+=String.fromCharCode(ak)}if(ap!==64){e+=String.fromCharCode(aj)}}while(ao<al.length);return e}function S(aj,e,al){var ak;switch(e){case"BOOL":ak=(aj.charCodeAt(0)!="0");break;case"BYTE":case"USINT":ak=P(aj);break;case"SINT":ak=ad(aj);break;case"WORD":case"UINT":ak=L(aj);break;case"INT":case"INT16":ak=K(aj);break;case"INT1DP":ak=((K(aj))/10).toFixed(1);break;case"DWORD":case"UDINT":ak=E(aj);break;case"DINT":ak=N(aj);break;case"REAL":ak=q(aj);if(al!==undefined){ak=ak.toFixed(parseInt(al,10))}break;case"LREAL":ak=D(aj);if(al!==undefined){ak=ak.toFixed(parseInt(al,10))}break;case"STRING":ak=Z(aj);break;case"TOD":case"TIME_OF_DAY":ak=n(aj,al);break;case"TIME":ak=U(aj,al);break;case"DT":case"DATE":case"DATE_AND_TIME":ak=ab(aj,al);break;case"EndStruct":break;default:k("TAME library error: Unknown data type at parsing read request: "+e);break}return ak}function v(aC){var aj,au=aC.reqDescr.items,ar=[],av=0,az,al,am,aB,ap,ax,aq,aA,ak,aw,at,an,ao;try{aj=aC.xmlHttpReq.responseXML.documentElement;al=O(aj.getElementsByTagName("ppData")[0].firstChild.data);for(at=0,an=au.length;at<an;at++){az=au[at];ar=ae(az);ak=ar[0];aw=ar[1];ax=z[ak];switch(ak){case"STRING":if(aw!==undefined){ap=parseInt(aw,10)}ax=(ah(ap)?ap:ax)+1;break;case"EndStruct":ax=az.val;break}aq=ax<a?ax:a;if(aC.reqDescr.seq!==true){ao=j(aC.reqDescr);av=az.addr-ao}else{if(aC.reqDescr.calcAlignment===true&&aq>1&&ak!=="EndStruct"&&ak!=="STRING"&&av>0){aA=av%aq;if(aA>0){av+=aq-aA}}}am=al.substr(av,ax);aB=S(am,ak,aw);if(ak!=="EndStruct"){y(az.jvar,aB,aC.reqDescr.dataObj,az.prefix,az.suffix)}if(aC.reqDescr.seq===true){av+=ax}}}catch(ay){k("TAME library error: Parsing of Read Request failed:"+ay);k(az);return}}function c(aI){var aj,aw=aI.reqDescr.items,au=[],aA=0,al=0,ay=window,aF=0,aE,an,ao,aH,aC,am,aB,av,ar,ap,ax,az,at,aq;function ak(){var aJ,e;if(am==="STRING"){if(aB!==undefined){aJ=parseInt(aB,10)}else{if(typeof M[aE.name].stringLength==="number"){aJ=M[aE.name].stringLength}}aC=(ah(aJ)?aJ:aC)+1}e=ao.substr(al,aC);aH=S(e,am,aB);y(ax,aH,ay,aE.prefix,aE.suffix);al+=aC}function aG(){var aK,aJ,aO,aN,aL,aM;function e(){var aQ,aP;if(a>1&&am!=="STRING"&&am!=="EndStruct"){aQ=aC<a?aC:a;if(aQ>1&&al>0){aP=al%aQ;if(aP>0){al+=aQ-aP}}if(aQ>aF){aF=aQ}}}for(aM in aE.def){if(aE.def.hasOwnProperty(aM)){aJ=aE.def[aM].split(".");if(aJ[0]==="ARRAY"){aO=parseInt(aJ[1],10);aN=aJ.length-1;for(aK=0;aK<aO;aK++){am=aJ[2];if(aJ[aN]==="SP"){ax=aM+aK;if(aN>=4){aB=aJ.slice(3,-1).join(".")}}else{ax=aM+"."+aK;if(aN>=3){aB=aJ.slice(3).join(".")}}if(az!==null){ax=az+"."+ax}aC=z[am];e();ak()}}else{if(az!==null){ax=az+"."+aM}else{ax=aM}am=aJ[0];aB=aJ.slice(1).join(".");aC=z[am];e();ak()}}}if(a>1&&aF>1&&am!=="STRING"&&am!=="EndStruct"){if(aF>a){aF=a}aL=al%aF;if(aL>0){al+=aF-aL}}}try{aj=aI.xmlHttpReq.responseXML.documentElement;an=O(aj.getElementsByTagName("ppRdData")[0].firstChild.data);for(av=0,ar=aw.length;av<ar;av++){ao=an.substr(aA,4);ap=S(ao,"DWORD");if(ap!==0){k("TAME library error: ADS sub command error while processing a SumReadRequest!");k("Error code: "+ap);k(aw[av])}aA+=4}for(av=0;av<ar;av++){aE=aw[av];au=ae(aE);am=au[0];aB=au[1];aq=M[aE.name].size;az=null;ao=an.substr(aA,aq);switch(am){case"ARRAY":ay=y(aE.jvar);al=0;at=M[aE.name].arrayLength;if(M[aE.name].arrayDataType==="USER"){for(az=0;az<at;az++){aG()}}else{am=M[aE.name].arrayDataType;aC=z[am];for(az=0;az<at;az++){ax=az;ak()}}break;case"USER":ay=y(aE.jvar);al=0;aG();break;default:ay=window;aH=S(ao,am,aB);y(aE.jvar,aH,ay,aE.prefix,aE.suffix)}aA+=aq}}catch(aD){k("TAME library error: Parsing of SumReadRequest failed:"+aD);k(aE);return}}function w(aB){var aj,at=aB.reqDescr.items,aq=[],av=0,ak=0,au=window,az,am,an,aA,ax,al,aw,ar,ap,ao;try{aj=aB.xmlHttpReq.responseXML.documentElement;am=O(aj.getElementsByTagName("ppRdData")[0].firstChild.data);for(ar=0,ap=at.length;ar<ap;ar++){an=am.substr(av,4);ao=S(an,"DWORD");if(ao!==0){k("TAME library error: ADS sub command error while processing a SumReadRequest!");k("Error code: "+ao);k(at[ar])}av+=4}}catch(ay){k("TAME library error: Parsing of SumWriteRequest failed:"+ay);k(az);return}}function af(al){var aj;try{aj=al.xmlHttpReq.responseXML.documentElement;W.adsState=parseInt(aj.getElementsByTagName("pAdsState")[0].firstChild.data,10);W.adsStateTxt=Q[W.adsState];W.deviceState=parseInt(aj.getElementsByTagName("pDeviceState")[0].firstChild.data,10)}catch(ak){k("TAME library error: Parsing of ADS Read State Request failed:"+ak);return}}function J(ap,an,al){var ak={},am,aj;aj=z[an];if(typeof al.name==="string"){al.name=al.name.toUpperCase()}switch(an){case"STRING":if(ah(al.strlen)){an+="."+al.strlen;aj=al.strlen}else{if(h===true){try{aj=M[al.name].stringLength;an+="."+aj}catch(ao){k("TAME library error: A problem occured while reading the string length from the symbol table!");k(ao)}}}aj++;break;case"TIME":case"TOD":case"DT":case"DATE":case"DATE_AND_TIME":case"TIME_OF_DAY":if(typeof al.format==="string"){an+="."+al.format}break;case"REAL":case"LREAL":if(typeof al.decPlaces==="number"){an+="."+al.decPlaces}else{if(typeof al.dp==="number"){an+="."+al.dp}}break}ak={addr:al.addr,name:al.name,id:al.id,oc:al.oc,ocd:al.ocd,readLength:aj,debug:al.debug,sync:al.sync,seq:true,items:[{val:al.val,jvar:al.jvar,type:an,prefix:al.prefix,suffix:al.suffix}]};if(ap==="Write"){W.writeReq(ak)}else{W.readReq(ak)}}function F(am,an,al){var ao={},aA={},av,ak,aC=0,aD=0,aB=0,aE,aj=[],aH,aq,au=0,aw,ar,aG=0,ax=0,aJ,at,aI,ay;if(typeof al.name==="string"){al.name=al.name.toUpperCase()}if(am==="Write"&&typeof al.val==="object"){aA=al.val}else{if(typeof al.jvar==="string"){aA=y(al.jvar)}else{k("TAME library error: No data object for this "+am+"-Request defined!")}}if(typeof al.arrlen==="number"){av=al.arrlen}else{if(h===true){try{av=M[al.name].arrayLength}catch(aF){k("TAME library error: A proble occured while reading the array length from the symbol table!");k(aF)}}else{k("TAME library error: Can't get the array length for this request!")}}if(typeof al.item==="number"&&!isNaN(al.item)&&am==="Write"){aI=true;if(al.item<0||al.item>av-1){k('TAME library error: Wrong value for "item"!');k("item: "+al.item);k("Last array index: "+(av-1))}}function ap(){var e;if(typeof al.def==="string"){al.def=y(al.def)}else{if(typeof al.def!=="object"){k("TAME library error: No structure definition found!")}}for(e in al.def){if(al.def.hasOwnProperty(e)){aj=al.def[e].split(".");if(aj[0]==="ARRAY"){aH=parseInt(aj[1],10);aj.shift();aj.shift()}else{aH=1}for(aD=0;aD<aH;aD++){if(aj[0]==="STRING"){if(typeof aj[1]==="string"){aw=parseInt(aj[1],10)}ar=(ah(aw)?aw:z[aj[0]])+1}else{ar=z[aj[0]]}if(a>1&&ar>1&&aj[0]!=="STRING"&&au>0){aJ=au%ar;if(aJ>0){au+=ar-aJ}}au+=ar}if(a>1&&ar>aG&&aj[0]!=="STRING"){aG=ar}}}if(a>1&&aG>1&&aj[0]!=="STRING"){if(aG>a){aG=a}aJ=au%aG;if(aJ>0){ax=aG-aJ;au+=ax}}if(aI){ak=au*al.item;av=1}ao={addr:al.addr,name:al.name,addrOffset:ak,id:al.id,oc:al.oc,ocd:al.ocd,debug:al.debug,readLength:au*av,seq:true,calcAlignment:true,dataObj:aA,sync:al.sync,items:[]};for(aD=0;aD<av;aD++){for(e in al.def){if(al.def.hasOwnProperty(e)){aj=al.def[e].split(".");if(aj[0]==="ARRAY"){aH=parseInt(aj[1],10);aq=aj.length-1;for(aB=0;aB<aH;aB++){if(aj[aq]==="SP"){ao.items[aC]={jvar:aD+"."+e+aB};if(aq===4){ao.items[aC].type=aj[2]+"."+aj[3]}else{ao.items[aC].type=aj[2]}}else{ao.items[aC]={jvar:aD+"."+e+"."+aB};if(aq===3){ao.items[aC].type=aj[2]+"."+aj[3]}else{ao.items[aC].type=aj[2]}}if(am==="Write"){if(aI){if(aj[aq]==="SP"){ao.items[aC].val=aA[al.item][e+aB]}else{ao.items[aC].val=aA[al.item][e][aB]}}else{if(aj[aq]==="SP"){ao.items[aC].val=aA[aD][e+aB]}else{ao.items[aC].val=aA[aD][e][aB]}}}aC++}}else{ao.items[aC]={jvar:aD+"."+e,type:al.def[e]};if(am==="Write"){if(aI){ao.items[aC].val=aA[al.item][e]}else{ao.items[aC].val=aA[aD][e]}}aC++}}}if(a>1){ao.items[aC]={type:"EndStruct",val:ax};aC++}}}function az(){aE=z[an];switch(an){case"STRING":if(ah(al.strlen)){an+="."+al.strlen;aE=al.strlen}else{if(h===true){aE=M[al.name].stringLength;an+="."+aE}}aE++;break;case"TIME":case"TOD":case"DT":case"DATE":case"DATE_AND_TIME":case"TIME_OF_DAY":if(typeof al.format==="string"){an+="."+al.format}break;case"REAL":case"LREAL":if(typeof al.decPlaces==="number"){an+="."+al.decPlaces}else{if(typeof al.dp==="number"){an+="."+al.dp}}break}if(aI){ak=al.item*aE;av=1}ao={addr:al.addr,name:al.name,addrOffset:ak,id:al.id,oc:al.oc,ocd:al.ocd,readLength:aE*av,debug:al.debug,seq:true,dataObj:aA,items:[]};for(aD=0;aD<av;aD++){ao.items[aD]={jvar:aD,type:an};if(am==="Write"){if(aI){ao.items[aD].val=aA[al.item]}else{ao.items[aD].val=aA[aD]}}}}if(an==="STRUCT"){ap()}else{az()}if(am==="Write"){W.writeReq(ao)}else{W.readReq(ao)}}function Y(e,aq){var an={},aj={},ar=[],al=0,ap,ak,am,ao;if(typeof aq.name==="string"){aq.name=aq.name.toUpperCase()}if(e==="Write"&&typeof aq.val==="object"){aj=aq.val}else{if(typeof aq.jvar==="string"){aj=y(aq.jvar)}else{k("TAME library error: No data object for this "+e+"-Request defined!")}}if(typeof aq.def==="string"){aq.def=y(aq.def)}else{if(typeof aq.def!=="object"){k("TAME library error: No structure defininition found!")}}an={addr:aq.addr,name:aq.name,id:aq.id,oc:aq.oc,ocd:aq.ocd,debug:aq.debug,seq:true,calcAlignment:true,dataObj:aj,sync:aq.sync,items:[]};for(am in aq.def){if(aq.def.hasOwnProperty(am)){ar=aq.def[am].split(".");if(ar[0]==="ARRAY"){ak=parseInt(ar[1],10);ap=ar.length-1;for(ao=0;ao<ak;ao++){if(ar[ap]==="SP"){an.items[al]={jvar:am+ao};if(ap===4){an.items[al].type=ar[2]+"."+ar[3]}else{an.items[al].type=ar[2]}}else{an.items[al]={jvar:am+"."+ao};if(ap===3){an.items[al].type=ar[2]+"."+ar[3]}else{an.items[al].type=ar[2]}}if(e==="Write"){if(ar[ap]==="SP"){an.items[al].val=aj[am+ao]}else{an.items[al].val=aj[am][ao]}}al++}}else{an.items[al]={jvar:am,type:aq.def[am]};if(e==="Write"){an.items[al].val=aj[am]}al++}}}if(e==="Write"){W.writeReq(an)}else{W.readReq(an)}}this.writeReq=function(al){var an=al.items,av={},e=[],aq=[],ay=[],ap,au,ak,ao,aj,aw,ar,ax,am,at;if(typeof al.name==="string"){al.name=al.name.toUpperCase()}for(at=0,ak=an.length;at<ak;at++){ax=an[at];aq=ae(ax);ap=aq[0];au=aq[1];if(isNaN(z[ap])){k("TAME library error: Could not get the length of the data type: "+ap);k("TAME library error: Probably wrong type definition. Please check the manual.");k(al);return}ao=(z[ap]<a)?z[ap]:a;if(al.calcAlignment===true&&ao>1&&ap!=="STRING"&&ap!=="EndStruct"&&e.length>0){ar=e.length%ao;if(ar>0){aw=ao-ar;for(am=1;am<=aw;am++){e.push(0)}}}if(ap==="EndStruct"){for(am=1;am<=ax.val;am++){e.push(0)}}else{ay=d(ax,ap,au,z[ap]);e=e.concat(ay)}}if(e&&e.length>0){e=o(e)}av={method:"Write",indexGroup:x(al),indexOffset:j(al),pData:e,reqDescr:al};t(av).send()};this.readReq=function(ak){var at={},al=ak.items,an=[],au,ar,am,e,ao,ap,av,aq,aj;if(typeof ak.name==="string"){ak.name=ak.name.toUpperCase()}if(typeof ak.readLength!=="number"){ak.readLength=0;for(aq=0,e=al.length;aq<e;aq++){au=al[aq];an=ae(au);am=an[0];ar=an[1];if(isNaN(z[am])){k("TAME library error: Could not get the length of the data type: "+am);k("TAME library error: Probably wrong type definition. Please check the manual.");k(ak);return}if(am==="STRING"){if(typeof ar==="string"){av=parseInt(ar,10)}ap=(ah(av)?av:z[am])+1}else{ap=z[am]}if(ak.seq===true){if(ak.calcAlignment===true&&ap>1&&am!=="EndStruct"&&am!=="STRING"&&ak.readLength>0){ao=ak.readLength%ap;if(ao>0){ak.readLength+=ap-ao}}ak.readLength+=ap}else{aj=j(ak);ak.readLength=ap+au.addr-aj}}}at={method:"Read",indexGroup:x(ak),indexOffset:j(ak),reqDescr:ak};t(at).send()};this.sumReadReq=function(ak){var at={},am=ak.items,ap=[],av=[],aw=[],aj=am.length,al={},ao,ar,au,aq,an,e;ak.readLength=aj*4;for(aq=0;aq<aj;aq++){au=am[aq];if(typeof au.name==="string"){au.name=au.name.toUpperCase()}ap=ae(au);ao=ap[0];ar=ap[1];an=M[au.name].size;ak.readLength+=an;al.val=x(au);aw=d(al,"UDINT",ar,4);av=av.concat(aw);al.val=j(au);aw=d(al,"UDINT",ar,4);av=av.concat(aw);al.val=an;aw=d(al,"UDINT",ar,4);av=av.concat(aw)}if(av.length>0){e=o(av)}at={method:"ReadWrite",indexGroup:l.SumRd,indexOffset:am.length,pwrData:e,reqDescr:ak};t(at).send()};this.sumWriteReq=function(al){var aE={},ar=al.items,ao=[],aj=[],aq=[],am=ar.length,aB={},az=0,ak,aw,ay,ap,ax,aD,av,au,an,aA,e;function at(){var aF;ax=z[ak];if(ak==="STRING"){if(aw!==undefined){aF=parseInt(aw,10)}else{if(typeof M[ay.name].stringLength==="number"){aF=M[ay.name].stringLength}}aw=(ah(aF)?aF:ax)}}function aC(){var aI,aN,aF,aJ,aL,aG,aH=[];function aM(){var aP,aO;if(a>1&&ak!=="STRING"&&ak!=="EndStruct"){aP=ax<a?ax:a;if(aP>1&&aH.length>0){aL=aH.length%aP;if(aL>0){e=aP-aL;for(aO=1;aO<=e;aO++){aH.push(0)}}}if(aP>az){az=aP}}}for(aG in ay.def){if(ay.def.hasOwnProperty(aG)){try{aN=ay.def[aG].split(".");if(aN[0]==="ARRAY"){aF=parseInt(aN[1],10);aJ=aN.length-1;for(aI=0;aI<aF;aI++){ak=aN[2];if(aN[aJ]==="SP"){if(aJ>=4){aw=aN.slice(3,-1).join(".")}}else{if(aJ>=3){aw=aN.slice(3).join(".")}}if(av!==null){if(aN[aJ]==="SP"){aB.val=ay.val[av][aG+aI]}else{aB.val=ay.val[av][aG][aI]}}else{aB.val=ay.val[aG][aI]}at();aM();aq=d(aB,ak,aw,ax);aH=aH.concat(aq)}}else{if(av!==null){aB.val=ay.val[av][aG]}else{aB.val=ay.val[aG]}ak=aN[0];aw=aN.slice(1).join(".");at();aM();aq=d(aB,ak,aw,ax);aH=aH.concat(aq)}}catch(aK){k("TAME library error: Could not set values for a structure in SumWriteReq: "+aK);k(ay)}}}if(a>1&&az>1&&aN[0]!=="STRING"&&aN[0]!=="EndStruct"){aL=aH.length%az;if(aL>0){e=az-aL;for(au=1;au<=e;au++){aH.push(0)}}}aj=aj.concat(aH)}al.readLength=am*4;for(ap=0;ap<am;ap++){ay=ar[ap];if(typeof ay.name==="string"){ay.name=ay.name.toUpperCase()}ao=ae(ay);ak=ao[0];aw=ao[1];ax=M[ay.name].size;aB.val=x(ay);aq=d(aB,"UDINT",aw,4);aj=aj.concat(aq);aB.val=j(ay);aq=d(aB,"UDINT",aw,4);aj=aj.concat(aq);aB.val=ax;aq=d(aB,"UDINT",aw,4);aj=aj.concat(aq)}for(ap=0;ap<am;ap++){ay=ar[ap];if(typeof ay.name==="string"){ay.name=ay.name.toUpperCase()}ao=ae(ay);ak=ao[0];aw=ao[1];ax=M[ay.name].size;av=null;switch(ak){case"ARRAY":an=parseInt(M[ay.name].arrayLength,10);if(an!==ay.val.length){k("TAME library error: Array length in JS differs from the length in the PLC!");k("Length in JS: "+ay.val.length);k("Length in PLC: "+an);k(ay);return}if(M[ay.name].arrayDataType==="USER"){for(av=0;av<an;av++){aC()}}else{ak=M[ay.name].arrayDataType;if(ak==="STRING"){aw=M[ay.name].stringLength}else{ax=M[ay.name].itemSize}for(av=0;av<an;av++){aB.val=ay.val[av];aq=d(aB,ak,aw,ax);aj=aj.concat(aq)}}break;case"USER":aC();break;default:if(ak==="STRING"){aw=M[ay.name].stringLength}else{ax=M[ay.name].size}aq=d(ay,ak,aw,ax);aj=aj.concat(aq)}}if(aj.length>0){aD=o(aj)}aE={method:"ReadWrite",indexGroup:l.SumWr,indexOffset:ar.length,pwrData:aD,reqDescr:al};t(aE).send()};this.readAdsState=function(e){var aj={method:"ReadState",reqDescr:e};t(aj).send()};this.logSymbols=function(){k(M)};this.getSymbolsAsJSON=function(){var ak;if(typeof JSON!=="object"){k("TAME library error: No JSON parser found.")}else{try{ak=JSON.stringify(M);return ak}catch(aj){k("TAME library error: Could not convert the Symbol Table to JSON:"+aj)}}};this.setSymbolsFromJSON=function(ak){if(typeof JSON!=="object"){k("TAME library error: No JSON parser found.")}else{try{M=JSON.parse(ak)}catch(aj){k("TAME library error: Could not create the Symbol Table from JSON:"+aj);return}h=true;k("TAME library info: Symbol Table successfully created from JSON data.")}};this.parseResponse=function(ao){var ak,an,aj;if(typeof ao.reqDescr.id==="number"){C[ao.reqDescr.id]=0}if(ao.xmlHttpReq.responseXML===null){k('TAME library error: Request contains no XML data. Object "responseXML" is null.');k('TAME library error: This is the "responseText":');k(ao.xmlHttpReq.responseText)}try{ak=ao.xmlHttpReq.responseXML.documentElement}catch(am){k("TAME library error: No XML data in server response:"+am);return}try{aj=ak.getElementsByTagName("faultstring")[0].firstChild.data;try{an=ak.getElementsByTagName("errorcode")[0].firstChild.data}catch(am){an="-"}k("TAME library error: Message from server:  "+aj+" ("+an+")");return}catch(al){an=0}if(typeof ak.normalize==="function"){ak.normalize()}if(ao.method==="ReadState"){af(ao)}else{if(ao.method==="Read"||ao.method==="ReadWrite"){switch(ao.indexGroup){case l.UploadInfo:T(ao);break;case l.Upload:aa(ao);break;case l.SumRd:c(ao);break;case l.SumWr:w(ao);break;default:v(ao)}}}if(typeof ao.reqDescr.oc==="function"){if(typeof ao.reqDescr.ocd==="number"){window.setTimeout(ao.reqDescr.oc,ao.reqDescr.ocd)}else{ao.reqDescr.oc()}}};this.writeBool=function(e){J("Write","BOOL",e)};this.writeByte=function(e){J("Write","BYTE",e)};this.writeUsint=function(e){J("Write","USINT",e)};this.writeSint=function(e){J("Write","SINT",e)};this.writeWord=function(e){J("Write","WORD",e)};this.writeUint=function(e){J("Write","UINT",e)};this.writeInt=function(e){J("Write","INT",e)};this.writeInt1Dp=function(e){J("Write","INT1DP",e)};this.writeDword=function(e){J("Write","DWORD",e)};this.writeUdint=function(e){J("Write","UDINT",e)};this.writeDint=function(e){J("Write","DINT",e)};this.writeReal=function(e){J("Write","REAL",e)};this.writeLreal=function(e){J("Write","LREAL",e)};this.writeString=function(e){J("Write","STRING",e)};this.writeTime=function(e){J("Write","TIME",e)};this.writeTod=function(e){J("Write","TOD",e)};this.writeDate=function(e){J("Write","DATE",e)};this.writeDt=function(e){J("Write","DT",e)};this.readBool=function(e){J("Read","BOOL",e)};this.readByte=function(e){J("Read","BYTE",e)};this.readUsint=function(e){J("Read","USINT",e)};this.readSint=function(e){J("Read","SINT",e)};this.readWord=function(e){J("Read","WORD",e)};this.readUint=function(e){J("Read","UINT",e)};this.readInt=function(e){J("Read","INT",e)};this.readInt1Dp=function(e){J("Read","INT1DP",e)};this.readDword=function(e){J("Read","DWORD",e)};this.readUdint=function(e){J("Read","UDINT",e)};this.readDint=function(e){J("Read","DINT",e)};this.readReal=function(e){J("Read","REAL",e)};this.readLreal=function(e){J("Read","LREAL",e)};this.readString=function(e){J("Read","STRING",e)};this.readTime=function(e){J("Read","TIME",e)};this.readTod=function(e){J("Read","TOD",e)};this.readDate=function(e){J("Read","DATE",e)};this.readDt=function(e){J("Read","DT",e)};this.writeStruct=function(e){Y("Write",e)};this.readStruct=function(e){Y("Read",e)};this.writeArrayOfBool=function(e){F("Write","BOOL",e)};this.writeArrayOfByte=function(e){F("Write","BYTE",e)};this.writeArrayOfUsint=function(e){F("Write","USINT",e)};this.writeArrayOfSint=function(e){F("Write","SINT",e)};this.writeArrayOfWord=function(e){F("Write","WORD",e)};this.writeArrayOfUint=function(e){F("Write","UINT",e)};this.writeArrayOfInt=function(e){F("Write","INT",e)};this.writeArrayOfInt1Dp=function(e){F("Write","INT1DP",e)};this.writeArrayOfDword=function(e){F("Write","DWORD",e)};this.writeArrayOfUdint=function(e){F("Write","UDINT",e)};this.writeArrayOfDint=function(e){F("Write","DINT",e)};this.writeArrayOfReal=function(e){F("Write","REAL",e)};this.writeArrayOfLreal=function(e){F("Write","LREAL",e)};this.writeArrayOfString=function(e){F("Write","STRING",e)};this.writeArrayOfTime=function(e){F("Write","TIME",e)};this.writeArrayOfTod=function(e){F("Write","TOD",e)};this.writeArrayOfDate=function(e){F("Write","DATE",e)};this.writeArrayOfDt=function(e){F("Write","DT",e)};this.writeArrayOfStruct=function(e){F("Write","STRUCT",e)};this.readArrayOfBool=function(e){F("Read","BOOL",e)};this.readArrayOfByte=function(e){F("Read","BYTE",e)};this.readArrayOfUsint=function(e){F("Read","USINT",e)};this.readArrayOfSint=function(e){F("Read","SINT",e)};this.readArrayOfWord=function(e){F("Read","WORD",e)};this.readArrayOfUint=function(e){F("Read","UINT",e)};this.readArrayOfInt=function(e){F("Read","INT",e)};this.readArrayOfInt1Dp=function(e){F("Read","INT1DP",e)};this.readArrayOfDword=function(e){F("Read","DWORD",e)};this.readArrayOfUdint=function(e){F("Read","UDINT",e)};this.readArrayOfDint=function(e){F("Read","DINT",e)};this.readArrayOfReal=function(e){F("Read","REAL",e)};this.readArrayOfLreal=function(e){F("Read","LREAL",e)};this.readArrayOfString=function(e){F("Read","STRING",e)};this.readArrayOfTime=function(e){F("Read","TIME",e)};this.readArrayOfTod=function(e){F("Read","TOD",e)};this.readArrayOfDate=function(e){F("Read","DATE",e)};this.readArrayOfDt=function(e){F("Read","DT",e)};this.readArrayOfStruct=function(e){F("Read","STRUCT",e)};function X(){var e={method:"Read",sync:true,indexGroup:l.UploadInfo,indexOffset:0,reqDescr:{readLength:8}};t(e).send()}function T(ao){var aj,ak,ap,am,al;try{aj=ao.xmlHttpReq.responseXML.documentElement;ak=O(aj.getElementsByTagName("ppData")[0].firstChild.data);ap=ak.substr(0,4);b=S(ap,"DWORD");ap=ak.substr(4,4);u=S(ap,"DWORD")}catch(an){k("TAME library error: Parsing of UploadInfo failed:"+an);return}al={method:"Read",sync:true,indexGroup:l.Upload,indexOffset:0,reqDescr:{readLength:u}};t(al).send()}function aa(aB){var aj,at=0,ay=4,av=8,aq=12,an=30,am,ao,aA,ar,au,ak,az,ap,al,ax;try{aj=aB.xmlHttpReq.responseXML.documentElement;am=O(aj.getElementsByTagName("ppData")[0].firstChild.data);for(ar=0;ar<b;ar++){ao=am.substr(at,4);au=S(ao,"DWORD");ak=am.substring(at+an,(at+au)).split(String.fromCharCode(0));name=ak[0].toUpperCase();M[name]={typeString:ak[1],indexGroup:S(am.substr(at+ay,4),"DWORD"),indexOffset:S(am.substr(at+av,4),"DWORD"),size:S(am.substr(at+aq,4),"DWORD")};az=ak[1].split(" ");if(az[0]==="ARRAY"){M[name].type=az[0];ap=az[1].substring(1,az[1].length-1);ap=ap.split("..");ap=parseInt(ap[1],10)-parseInt(ap[0],10)+1;M[name].arrayLength=ap;al=az[3].split("(");if(al[1]!==undefined){al[1]=al[1].substr(0,al[1].length-1);M[name].fullType=az[0]+"."+ap+"."+al[0]+"."+al[1];M[name].stringLength=parseInt(al[1],10)}else{M[name].fullType=az[0]+"."+ap+"."+al[0]}M[name].itemSize=M[name].size/ap;M[name].arrayDataType="USER";for(ax in z){if(z.hasOwnProperty(ax)){if(al[0]===ax){M[name].arrayDataType=al[0]}}}}else{al=az[0].split("(");if(al[1]!==undefined){al[1]=al[1].substr(0,al[1].length-1);M[name].fullType=al[0]+"."+al[1];M[name].stringLength=parseInt(al[1],10)}else{M[name].fullType=al[0]}M[name].type="USER";for(ax in z){if(z.hasOwnProperty(ax)){if(al[0]===ax){M[name].type=al[0]}}}}at+=au}h=true;k("TAME library info: End of fetching the symbols.");k("TAME library info: Symbol table ready.")}catch(aw){k("TAME library error: Parsing of uploaded symbol information failed:"+aw);return}}if(f.dontFetchSymbols===true){k("TAME library info: Reading of the UploadInfo deactivated. Symbol Table could not be created.")}else{k("TAME library info: Start fetching the symbols from PLC.");try{X()}catch(ag){k("TAME library error: Could'nt fetch the symbol information from the PLC:"+ag);return}}};TAME.WebServiceClient.createClient=function(a){return new TAME.WebServiceClient(a)};